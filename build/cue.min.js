(function(a){function b(a,b,c){const d=Date.now();"object"==typeof b&&(b=JSON.stringify(b));const e=`${a}::ts`;R.setItem(a,b),R.setItem(e,`${d+1e3*c}`);let f=R.getItem(T);null===f?f=`${a},${e},`:-1===f.indexOf(`${a},`)&&(f=`${f}${a},${e},`),R.setItem(T,f)}function c(a){const b=R.getItem(`${a}::ts`);return null===b?U:+b<Date.now()?(d(a),U):JSON.parse(R.getItem(a))}function d(a){if(!a){const a=R.getItem(T);if(null!==a){const b=a.split(",");for(let a=0;a<b.length;a++)R.removeItem(b[a]);R.removeItem(T)}}else if(null!==R.getItem(a)){const b=`${a}::ts`;R.removeItem(a),R.removeItem(b);const c=R.getItem(T);if(null!==c){const d=c.split(",");d.splice(d.indexOf(a),1),d.splice(d.indexOf(b),1),R.setItem(T,`${d.join(",")},`)}}}function e(a,b,c,d={}){if(S.has(a))return S.get(a);else{const e={"Content-Type":"application/json"};return c&&(e.Authorization=`Bearer ${c}`),S.set(a,new Promise((c,f)=>{fetch(a,{method:b,mode:"cors",cache:"no-cache",credentials:"same-origin",headers:e,redirect:"follow",referrer:"no-referrer",body:"GET"===b?null:"string"==typeof d?d:JSON.stringify(d)}).then(a=>{a.ok?a.json().then(a=>c(a)):a.json().then(a=>f(a))}).catch(a=>{f(a)}).finally(()=>{S.delete(a)})})),S.get(a)}}function f(c,a){if(c===a)return!0;if(c&&a&&"object"==typeof c&&"object"==typeof a){if(c.constructor!==a.constructor)return!1;let b;if(Array.isArray(c)){if(c.length!==a.length)return!1;for(b=e;0!=b--;)if(!f(c[b],a[b]))return!1;return!0}const d=Object.keys(c),e=d.length;if(e!==Object.keys(a).length)return!1;for(b=e;0!=b--;)if(!Object.prototype.hasOwnProperty.call(a,d[b]))return!1;for(b=e;0!=b--;){const e=d[b];if(!f(c[e],a[e]))return!1}return!0}return c!==c&&a!==a}function g(a){if(!a||"object"!=typeof a)return a;if(Array.isArray(a)){const b=[];for(let c=0;c<a.length;c++)b.push(g(a[c]));return b}const b=Object.keys(a),c={};for(let d,e=0;e<b.length;e++)d=b[e],c[d]=g(a[d]);return c}function h(c,a){if(c.length!==a.length)return!1;for(let b=0;b<c.length;b++)if(c[b]!==a[b])return!1;return!0}function i(c,a){const b=Object.keys(c),d=Object.keys(a);if(b.length!==d.length)return!1;for(let e,f=0;f<b.length;f++)if(e=b[f],-1===d.indexOf(e)||c[e]!==a[e])return!1;return!0}function j(a){return"function"==typeof a?a:W}function k(a){!1===$&&(Z=a,requestAnimationFrame(l))}function l(){$=!0;let a,b,c,d,e,f,g,h;for(b of _.entries())b[0](b[1]);for(;0<ba.size;){for(b of ba.entries())d=b[0],-1===da.indexOf(d)&&(e=b[1],g=e[0],f=e[1],d.needsUpdate=!0,h=d.value(e[2]),!0===d.hasChanged&&(f[d.ownPropertyName]&&aa.set(f[d.ownPropertyName],h),ca.set(d,e)),da.push(d));ba.clear();for(b of ca.entries())if(d=b[0],e=b[1],c=e[0].get(d.ownPropertyName),c)for(a=0;a<c.length;a++)ba.set(c[a],e);ca.clear()}for(b of aa.entries())b[0](b[1]);for(_.clear(),aa.clear();0<da.length;)da.pop();$=!1,Z(),Z=null,Y=null}function m(a,b){if(null!==a&&"object"==typeof a){let c,d;for(let e=1;e<b.length;e++)d=b[e],c=1==e?a:c[b[e-1]];if(c.hasOwnProperty(d))return[c,d];throw new Error(`Can not access store path: "${b.join("/")}". Property ".../${d}" does not exist.`)}else throw new Error(`Can not access store path: "${b.join("/")}". The value stored at: "${b[0]}" is not object or array.`)}function n(a,b){const c=ga.get(a);if(c){for(let a=0;a<c.length;a++)ea.cueEvent(c[a].handler,b);return ea.react()}return X}function o(a,b,c,d){const e=ga.get(a);if(e){let a,f,g,h,i=!1;for(a=0;a<e.length;a++)if(!0===e[a].bubbles){i=!0;break}if(!0==i){const b=[];let e=c[0],i=d,j=ga.get(e);if(j)for(a=0;a<j.length;a++)b.push([j[a],d]);for(a=1;a<c.length;a++)if(e+=`/${c[a]}`,i=i[c[a]],j=ga.get(e),j)for(f=0;f<j.length;f++)b.push([j[f],i]);for(a=b.length-1;0<=a;a--)g=b[a],h=g[0],ea.cueEvent(g[0].handler,g[1])}else for(a=0;a<e.length;a++)ea.cueEvent(e[a].handler,b);return ea.react()}return X}function p(a,b){return s(r(a,b))}function q(a){const b=new Map;let c,d,e;for(c of a.values())for(d=0;d<c.sourceProperties.length;d++)e=c.sourceProperties[d],b.has(e)?b.get(e).push(c):b.set(e,[c]);return b}function r(a,b){Object.assign(ka,{computedProperties:b});const c=new Proxy(a,{get:t});let d;for(d of b.values()){ka.computedProperty=d;try{d.computation.call(c,c)}catch(a){if(a.type&&"cue-internal"===a.type)throw new Error(a.message)}}return ka.computedProperty=null,ka.computedProperties=null,b}function s(a){la=a;const b=new Map;let c;for(c of a.keys())u(c,[],b);return la=null,ma=[],b}function t(a,b){const{computedProperty:c}=ka;if(!a.hasOwnProperty(b))throw{type:"cue-internal",message:`Cannot resolve computed property "${c.ownPropertyName}" because dependency "${b}" doesn't exist.`};-1===c.sourceProperties.indexOf(b)&&c.sourceProperties.push(b)}function u(a,b,c){if(la.has(a)){b.push(a),ma.push(a);const d=la.get(a);for(let a,e=0;e<d.sourceProperties.length;e++){if(a=d.sourceProperties[e],-1!==b.indexOf(a))throw new Error(`Circular dependency. "${d.ownPropertyName}" is required by "${a}": ${b.join(" -> ")}`);-1===ma.indexOf(a)&&u(a,b,c)}c.has(a)||c.set(a,d)}}function v(a,b){const c={encapsulated:!0===b.encapsulated,template:document.createRange().createContextualFragment(`<cue-template>${b.element?b.element.trim():""}</cue-template>`).firstChild},d=c.template.querySelectorAll(`[${pa}]`);c.refNames=new Map;let e,f,g;for(e=0;e<d.length;e++)f=d[e].getAttribute(oa),f&&f.length&&c.refNames.set(`${oa}${f}`,`[${pa}="${f}"]`);c.styles="","string"==typeof b.styles&&b.styles.length&&(c.styles=b.styles,w(a,c.styles,c.refNames,c.encapsulated));const h={};if(b.reactions){const a=new Set;for(f in b.reactions){if(g=b.reactions[f],"function"!=typeof g)throw new Error(`Reaction "${f}" is not a function...`);if(a.has(g))throw new Error(`Reaction "${f}" already in use. You can't use the same reaction for multiple data properties.`);h[f]=g,a.add(g)}}for(f in c.methods={},b)"initialize"!==f&&"connectedCallback"!==f&&"adoptedCallback"!==f&&"disconnectedCallback"!==f&&"function"==typeof b[f]&&(c.methods[f]=b[f]);c.construct=j(b.construct),c.initialize=j(b.initialize),c.connected=j(b.connectedCallback),c.disconnected=j(b.disconnectedCallback),c.adopted=j(b.adoptedCallback),c.data={},c.storeBindings={},c.reactions={};const l={},m=new Map;if(b.data)for(f in b.data)if(g=b.data[f],l[f]=g.value,"object"==typeof g.value&&null!==g.value&&g.value.id===ha.id?c.storeBindings[f]=g.value:"function"==typeof g.value?m.set(f,new na(f,g.value)):c.data[f]=g.value,g.reaction)if("string"==typeof g.reaction){if(!h[g.reaction])throw new Error(`No Reaction with name "${g.reaction}" exists.`);c.reactions[f]=h[g.reaction]}else if("function"==typeof g.reaction){if(h[f]||c.reactions[f])throw new Error(`A reaction for data property "${f}" has already been registered.`);c.reactions[f]=g.reaction}if(c.defaultAttributeValues={},c.attributeChangedCallbacks={},b.attributes)for(f in b.attributes){if(g=b.attributes[f],"undefined"!=typeof g.value)if("string"!=typeof g.value)throw new Error(`Attribute value for ${f} is not a String.`);else c.defaultAttributeValues[f]=g.value;if("string"==typeof g.reaction){if(!h[g.reaction])throw new Error(`No Reaction with name "${g.reaction}" exists.`);c.attributeChangedCallbacks[f]=h[g.reaction]}else"function"==typeof g.reaction&&(c.attributeChangedCallbacks[f]=g.reaction)}return c.computedProperties=p(l,m),c}function w(a,b,c,d){b=b.split(`${oa}self`).join(a);for(const e of c.entries())b=b.split(e[0]).join(e[1]);document.head.appendChild(ra),ra.innerHTML=b;const e=ra.sheet;let f="";for(let g,h,j=0;j<e.rules.length;j++)g=e.rules[j],!0===d||7===g.type||8===g.type?f+=g.cssText:1===g.type?!1===(h=x(g.selectorText,a))?f+=`${a} ${g.cssText}`:f+=g.cssText:4===g.type||12===g.type?f+=y(a,g,d):console.warn(`CSS Rule of type "${g.type}" is not currently supported by Cue Components.`);ra.innerHTML="",document.head.removeChild(ra);const g=document.createElement("style");g.id="cue::"+a,g.innerHTML=-1===f.indexOf(pa)?f.split(oa).join(pa):f,document.head.appendChild(g)}function x(a,b){return a===b?"":0===a.lastIndexOf(`${b} `,0)?" ":0===a.lastIndexOf(`${b}.`,0)?".":0===a.lastIndexOf(`${b}:`,0)?":":0===a.lastIndexOf(`${b}#`,0)?"#":0===a.lastIndexOf(`${b}[`,0)?"[":0===a.lastIndexOf(`${b}>`,0)?">":0===a.lastIndexOf(`${b}+`,0)?"+":!(0!==a.lastIndexOf(`${b}~`,0))&&"~"}function y(a,b,c,d=""){d+=4===b.type?`@media ${b.media.mediaText} {`:`@supports ${b.conditionText} {`;for(let e,f,g=0;g<b.cssRules.length;g++)e=b.cssRules[g],!0===c||7===e.type||8===e.type?d+=e.cssText:1===e.type?!1===(f=x(e.selectorText,a))?d+=`${a} ${e.cssText}`:d+=e.cssText:4===e.type||12===e.type?d+=y(a,e,c,d):console.warn(`CSS Rule of type "${e.type}" is not currently supported by Components.`);return`${d} }`}function z(a,b,c){let d,e;for(d of c.entries())e=a.querySelector(d[1]),e[qa]||(e[qa]={},e.renderEach=A),b[`${d[0]}`]=e;b[`${oa}self`]=a}function A(a,b,c=W){a||(a=[]);const d=this[qa].childData||[];if(this[qa].childData=a,0===a.length)(this[qa].shadowDom||this).textContent="";else if(0===d.length){const c=this[qa].shadowDom||this;for(let d=0;d<a.length;d++)c.appendChild(b(a[d]))}else B(this[qa].shadowDom||this,d,a,b,c)}function B(c,d,e,f,g){let h,j,k,l=0,m=0,n=!0,o=d.length-1,p=e.length-1,q=c.firstChild,r=q,s=c.lastChild,t=s;outer:for(;n;){n=!1;let a;for(h=d[l],j=e[m];h===j;){if(g(q,j),l++,m++,r=q=q.nextSibling,o<l||p<m)break outer;h=d[l],j=e[m]}for(h=d[o],j=e[p];h===j;){if(g(s,j),o--,p--,k=s,t=s=s.previousSibling,o<l||p<m)break outer;h=d[o],j=e[p]}for(h=d[o],j=e[m];h===j;){if(n=!0,g(s,j),a=s.previousSibling,c.insertBefore(s,r),t=s=a,m++,o--,o<l||p<m)break outer;h=d[o],j=e[m]}for(h=d[l],j=e[p];h===j;){if(n=!0,g(q,j),a=q.nextSibling,c.insertBefore(q,k),k=t=q,q=a,l++,p--,o<l||p<m)break outer;h=d[l],j=e[p]}}if(p<m){if(l<=o)for(let a;l<=o;)0===o?c.removeChild(s):(a=s.previousSibling,c.removeChild(s),s=a),o--;return}if(o<l){if(m<=p)for(;m<=p;)k?c.insertBefore(f(e[m]),k):c.appendChild(f(e[m])),m++;return}const u=Array(p+1-m),v=new Map;let w;for(w=m;w<=p;w++)u[w]=-1,v.set(e[w],w);let x=0,y=[];for(w=l;w<=o;w++)v.has(d[w])?(u[v.get(d[w])]=w,x++):y.push(w);if(0==x){for(c.textContent="",w=m;w<=p;w++)c.appendChild(f(e[w]));return}const z=C(u,m),A=[];let B=q;for(w=l;w<=o;w++)A[w]=B,B=B.nextSibling;for(w=0;w<y.length;w++)c.removeChild(A[y[w]]);let D,E=z.length-1;for(w=p;w>=m;w--)z[E]===w?(k=A[u[z[E]]],g(k,e[w]),E--):(-1===u[w]?D=f(e[w]):(D=A[u[w]],g(D,e[w])),c.insertBefore(D,k),k=D)}function C(a,b){var c=Math.floor;const d=[],e=[],f=Array(a.length);let g,h,k,m=-1;for(g=b;g<a.length;g++){if(h=a[g],0>h)continue;let b,i=-1,j=d.length;if(0<j&&d[j-1]<=h)k=j-1;else{for(;1<j-i;)b=c((i+j)/2),d[b]>h?j=b:i=b;k=i}-1!==k&&(f[g]=e[k]),k===m?(m++,d[m]=h,e[m]=g):h<d[k+1]&&(d[k+1]=h,e[k+1]=g)}for(g=e[m];0<=m;g=f[g],m--)d[m]=g;return d}function D(a){return new Promise(b=>{Ca=0,Ea=!1,Fa=null,Da=b,Ga=!1,ya[ta]||Da(null),E(a)})}function E(a){if(a===ta)null===Fa?F(ya,[ta]).then(a=>{Fa=a,!1===Ga&&(Ga=!0,Da(Fa))}):Da(Fa);else if(0===a.lastIndexOf(ta,0)){const b=a.substr(ta.length);if("#"!==b[0])throw new Error("Invalid route \""+b+"\". Nested routes must be hash based.");null===Fa?F(ya,[ta,...b.split("/")]).then(a=>{Fa=a,!1===Ga&&(Ga=!0,Da(Fa))}):F(ya.children,b.split("/")).then(a=>{!1===Ga&&(Ga=!0,Da(Object.assign(Fa,{nextNode:a})))})}else"#"===a[0]&&F(ya[ta].children,a.split("/")).then(a=>{!1===Ga&&(Ga=!0,Da(Object.assign(Fa,{nextNode:a})))})}function F(a,b,c=""){return new Promise(d=>{const e=b[0],f=a[e];if(!f||Ea)d({value:b.length&&c.length?c+"/"+b.join("/"):b.length?b.join("/"):c.length?c:"/",nextNode:null});else{c+=0===c.length?e:"/"+e;const g=b.slice(1);if(f.beforeRoute){const h=G(f.children,g);Promise.resolve(f.beforeRoute(h)).then(i=>{if(i="string"==typeof i?N(L(i)):h,h===i)d({value:c,onRoute:f.onRoute,nextNode:F(f.children,g)});else if(e===ta){if("/"!==h&&"#"!==h[0])throw new Error("Invalid Route Setup: \""+h+"\" can not directly follow root url. Routes at this level must start with a #.");if("#"!==i[0])throw new Error("Invalid Route \""+i+"\" returned from beforeRoute. Routes at this level must start with a #.");d({value:c,onRoute:f.onRoute,nextNode:F(f.children,i.split("/"))})}else"#"===e[0]?"/"===h?d({value:c,onRoute:f.onRoute,nextNode:F(f.children,i.split("/"))}):"/"===i||"#"===i[0]?J(b)&&d(F(a,i.split("/"))):d({value:c,onRoute:f.onRoute,nextNode:F(f.children,i.split("/"))}):i===ta||"#"===i[0]||0===i.lastIndexOf(ta,0)?J(b)&&E(i):d({value:c,onRoute:f.onRoute,nextNode:F(f.children,i.split("/"))})})}else f.onRoute?d({value:c,onRoute:f.onRoute,nextNode:F(f.children,g)}):d(F(f.children,g,c))}})}function G(a,b,c=""){const d=b[0],e=a[d];return e?(c+=0===c.length?d:"/"+d,e.beforeRoute||e.onRoute?c:G(e.children,b.slice(1),c)):b.length&&c.length?c+"/"+b.join("/"):b.length?b.join("/"):c.length?c:"/"}function H(a,b=[]){return new Promise(c=>{null===a.nextNode&&c(b),Promise.resolve(a.nextNode).then(d=>{null!==d&&(a.onRoute&&b.push([a.onRoute,d.value]),c(H(d,b)))})})}function I(a,b=""){return new Promise(c=>{null===a||"/"===a.value?c(b):Promise.resolve(a.nextNode).then(d=>{b+=a.value===ta||"#"===a.value[0]?a.value:`/${a.value}`,c(I(d,b))})})}function J(a){if(Ca++,Ca===Ma.options.recursionThrowCount)throw Ea=!0,new Error("Router.navigate is causing potentially infinite route rewrites at \""+a.join("/")+"\". Stopped execution after "+Ma.options.recursionThrowCount+" cycles...");else return Ca===Ma.options.recursionWarningCount&&console.warn("Router.navigate is causing more than "+Ma.options.recursionWarningCount+" route rewrites..."),!0}function K(a){if(-1<va.indexOf(a))return{relativeRoute:ta,absoluteRoute:ta};if("#"===a[0])return{relativeRoute:a,absoluteRoute:ta+a};if(a=M(a),"#"!==a[0])throw new Error("Invalid Route: \""+a+"\". Nested routes must be hash based.");return{relativeRoute:a,absoluteRoute:ta+a}}function L(a){return 1<a.length&&"/"===a[0]&&(a=a.substr(1)),1<a.length&&"/"===a[a.length-1]&&(a=a.slice(0,-1)),a}function M(a){const b=O(a,va);return b?a.substr(b.length):a}function N(a){const b=O(a,ua);return b?a.replace(b,ta):a}function O(a,b){return b.filter(b=>0===a.lastIndexOf(b,0)).sort((c,a)=>a.length-c.length)[0]}function P(a,b,c,d){let e;e=!1===d?b.bind(c):(d,f,g)=>{b.call(c,d,f,g);const h=a.indexOf(e);a.splice(h,1)},a.push(e)}function Q(a,b,c,d){if(a&&a.length)for(let e=0;e<a.length;e++)a[e](b,c,d)}const R=a.localStorage,S=new Map,T="CUE_SERVER_CACHE::KEYS",U=Symbol(),V=Object.defineProperty({fetch(a,d=0,f){return new Promise((g,h)=>{const i=c(a);i===U?e(a,"GET",f).then(c=>{b(a,c,d),g(c)}).catch(a=>{h(a)}):g(i)})},post(a,b,c){return new Promise((d,f)=>{e(a,"POST",c,b).then(a=>d(a)).catch(a=>f(a))})}},"clearCache",{value:d}),W=()=>{},X=Promise.resolve();let Y=null,Z=null,$=!1;const _=new Map,aa=new Map,ba=new Map,ca=new Map,da=[],ea={cueEvent(a,b){_.set(a,b)},cueCallback(a,b){aa.set(a,b)},cueComputations(a,b,c,d){const e=a.get(c),f=[a,b,d];for(let g=0;g<e.length;g++)ba.set(e[g],f)},react(){return Y||(Y=new Promise(k))}},fa=new Map,ga=new Map,ha=Object.defineProperty({get(a){if(!a){const a={};for(const b of fa.entries())a[b[0]]=g(b[1]);return a}const b=a.split("/"),c=fa.get(b[0]);if(void 0!==c){if(1<b.length){const[a,d]=m(c,b);return g(a[d])}return g(c)}},set(a,b){if(1===arguments.length&&"object"==typeof a&&null!==a){let b=!1;for(const c in a){const d=c.split("/"),e=fa.get(d[0]),g=a[c];if(1<d.length){const[a,h]=m(e,d);f(a[h],g)||(b=!0,a[h]=g,o(c,g,d,e))}else void 0!==e&&f(e,g)||(b=!0,fa.set(c,g),n(c,g))}return b?ea.react():X}const c=a.split("/"),d=fa.get(c[0]);if(1<c.length){const[e,g]=m(d,c);return f(e[g],b)?X:(e[g]=b,o(a,b,c,d))}return void 0!==d&&f(d,b)?X:(fa.set(a,b),n(a,b))},has(a){const b=a.split("/"),c=fa.get(b[0]);if(fa.has(b[0])){if(1<b.length)try{return m(c,b),!0}catch(a){return!1}return!0}return!1},remove(a){const b=a.split("/"),c=fa.get(b[0]);if(void 0===c)return console.warn(`Can't remove Store entry "${a}" because it doesn't exist.`),X;if(1<b.length){const[d,e]=m(c,b);return Array.isArray(d)?d.splice(parseInt(e),1):delete d[e],o(a,void 0,b,c)}return fa.delete(b[0]),n(a,void 0)},clear(a={silently:!1}){if(0===fa.size)return X;if(!0===a.silently)return fa.clear(),X;const b=fa.keys();fa.clear();const c=[];for(const d of b)c.push(n(d,void 0));return Promise.all(c)},bind(a,b){const c={id:this.id,path:a};return 1===arguments.length?c:Object.assign(c,{defaultValue:b})},subscribe(a,b,c={}){if("string"!=typeof a||"function"!=typeof b||null===c||"object"!=typeof c)throw new Error(`Invalid arguments. Expect (path:String, handler:Function, [options:Object]`);const d=Object.assign({bubbles:!1,autorun:!0},c,{handler:c.scope?b.bind(c.scope):b});if(ga.has(a)?ga.get(a).push(d):ga.set(a,[d]),!0===d.autorun){const b=a.split("/"),c=fa.get(b[0]);let e=!1;if(void 0===c)e=!0;else if(1<b.length){const[a,d]=m(c,b);void 0===a[d]&&(e=!0)}if(!0==e)console.warn(`Can not auto-run Store subscription handler because value at "${a}" is undefined. Pass {autorun: false} option to avoid this warning.`);else if(!1===d.bubbles)n(a,fa.get(a));else{const b=a.split("/");o(a,fa.get(a),b,fa.get(b[0]))}}return{unsubscribe(){const b=ga.get(a);b.splice(b.indexOf(d),1),0===b.length&&ga.delete(a)}}}},"id",{value:Symbol("Store ID")}),ia=1,ja=2,ka={computedProperty:null,computedProperties:null};let la=null,ma=[];class na{constructor(a,b,c=[]){this.ownPropertyName=a,this.computation=b,this.sourceProperties=c,this.intermediate=void 0,this._value=void 0,this._type=-1,this.needsUpdate=!0,this.hasChanged=!1}value(a){return!0===this.needsUpdate&&(this.intermediate=this.computation.call(a,a),Array.isArray(this.intermediate)?(this.hasChanged=this._type!==ia||!h(this._value,this.intermediate))&&(this._value=this.intermediate.slice(),this._type=ia):"object"==typeof this.intermediate&&null!==this.intermediate?(this.hasChanged=this._type!==ja||!i(this._value,this.intermediate))&&(this._value=Object.assign({},this.intermediate),this._type=ja):(this.hasChanged=this._value!==this.intermediate)&&(this._value=this.intermediate,this._type=0),this.needsUpdate=!1),this._value}}const oa="$",pa="\\$",qa=Symbol("Component Data"),ra=document.createElement("style"),sa={define(a,b){let c=null;const d=b.attributes?Object.keys(b.attributes):[],e=class extends HTMLElement{constructor(){super();let d,f;if(null===c)for(d in c=v(a,b),e.prototype.renderEach=A,c.methods)e.prototype[d]=c.methods[d];const h=new Map,i=g(c.data),j=this[qa]={_data:i,data:new Proxy(i,{get(a,b){return c.storeBindings[b]?ha.get(c.storeBindings[b].path):h.has(b)?h.get(b).value(j.data):g(a[b])}}),computedProperties:h,reactions:{},attributeChangedCallbacks:{},subscriptions:[],refs:{},initialized:!1};for(f of c.computedProperties.entries())h.set(f[0],new na(f[1].ownPropertyName,f[1].computation,f[1].sourceProperties));for(d in j.dependencyGraph=q(j.computedProperties),c.reactions)j.reactions[d]=c.reactions[d].bind(null,j.refs);for(d in c.attributeChangedCallbacks)j.attributeChangedCallbacks[d]=c.attributeChangedCallbacks[d].bind(null,j.refs);c.construct.call(this,this)}connectedCallback(){const b=this[qa];for(const a in c.storeBindings)b.dependencyGraph.has(a)&&b.subscriptions.push(ha.subscribe(c.storeBindings[a].path,()=>ea.cueComputations(b.dependencyGraph,b.reactions,a,b.data),{autorun:!1})),b.reactions[a]&&b.subscriptions.push(ha.subscribe(c.storeBindings[a].path,c=>ea.cueCallback(b.reactions[a],c),{autorun:!1}));if(!1===b.initialized){let d,e,f;if(!0===c.encapsulated){const a=b.shadowDom=this.attachShadow({mode:"open"});for(a.innerHTML=c.styles,d=0;d<this.childNodes.length;d++)a.appendChild(this.childNodes[d]);for(d=c.template.children.length-1;0<=d;d--)a.insertBefore(c.template.children[d].cloneNode(!0),this.firstChild)}else for(d=c.template.children.length-1;0<=d;d--)this.insertBefore(c.template.children[d].cloneNode(!0),this.firstChild);z(c.encapsulated?b.shadowDom:this,b.refs,c.refNames),b.initialized=!0;let g;for(f in c.storeBindings)if(g=c.storeBindings[f],e=g.path,ha.has(e))b.reactions[f]&&ea.cueCallback(b.reactions[f],ha.get(e));else if(g.hasOwnProperty("defaultValue"))ha.set(e,g.defaultValue);else throw new Error(`Component data of "${a}" has property "${f}" bound to Store["${e}"] but Store has no value and component specifies no default.`);for(f in b.reactions)ea.cueCallback(b.reactions[f],b.data[f]);for(f in b.attributeChangedCallbacks)ea.cueCallback(b.attributeChangedCallbacks[f],this.getAttribute(f));for(f in c.defaultAttributeValues)this.hasAttribute(f)||this.setAttribute(f,c.defaultAttributeValues[f]);ea.react().then(()=>{c.initialize.call(this,b.refs),c.connected.call(this,b.refs)})}else c.connected.call(this,b.refs)}disconnectedCallback(){for(const a=this[qa].subscriptions;a.length;)a.pop().unsubscribe();c.disconnected.call(this,this[qa].refs)}adoptedCallback(){c.adopted.call(this,this[qa].refs)}getData(a){if(!a){const b=this[qa],d={};for(var a in c.storeBindings)d[a]=ha.get(c.storeBindings[a].path);for(a in b._data)d[a]=g(b._data[a]);return d}return this[qa].data[a]}setData(a,b){if(1===arguments.length&&"object"==typeof a&&null!==a){const b=this[qa];let d=!1;for(const e in a){const g=b._data[e],h=a[e];if(c.computedProperties.has(e))throw new Error(`You can not set property "${e}" because it is a computed property.`);else c.storeBindings[e]?(d=!0,ha.set(c.storeBindings[e].path,h)):f(g,h)||(d=!0,b._data[e]=h,b.reactions[e]&&ea.cueCallback(b.reactions[e],h),b.dependencyGraph.has(e)&&ea.cueComputations(b.dependencyGraph,b.reactions,e,b.data))}return d?ea.react():X}if(c.storeBindings[a])return ha.set(c.storeBindings[a].path,b);if(c.computedProperties.has(a))throw new Error(`You can not set property "${a}" because it is a computed property.`);const d=this[qa],e=d._data[a];return f(e,b)?X:(d._data[a]=b,d.reactions[a]&&ea.cueCallback(d.reactions[a],b),d.dependencyGraph.has(a)&&ea.cueComputations(d.dependencyGraph,d.reactions,a,d.data),ea.react())}static get observedAttributes(){return d}attributeChangedCallback(a,b,c){const d=this[qa];if(!0===d.initialized){const b=d.attributeChangedCallbacks[a];b&&(ea.cueCallback(b,c),ea.react())}}};return customElements.define(a,e),(b={})=>{let c="<"+a;for(const a in b)c+=` ${a}="${b[a]}"`;return c+=`></${a}>`}},create(a,b){a=a.trim();const c="<"===a[0]?document.createRange().createContextualFragment(a).firstChild:document.createElement(a);if("object"==typeof b&&null!==b)if(c[qa])for(const a in b)c[qa]._data.hasOwnProperty(a)?c[qa]._data[a]=b[a]:console.warn(`Cannot pass data property "${a}" to component "${c.tagName}" because the property has not been explicitly defined in the components data model.`);else console.warn(`Cannot set data on element "${c.tagName}" because it has not been defined via Component.define!`);return c}},ta=a.location.origin+a.location.pathname,ua=[ta,a.location.hostname,a.location.hostname+"/",a.location.origin];"/"!==ta[ta.length-1]&&ua.push(ta+"/"),a.location.pathname&&"/"!==a.location.pathname&&ua.push(a.location.pathname);const va=["/","#","/#","/#/",...ua],wa=new Set,xa=new Map,ya={},za=new Map,Aa=[],Ba=[];let Ca=0,Da=null,Ea=!1,Fa=null,Ga=!1,Ha="",Ia=!1,Ja=!1,Ka="";const La={then:b=>b(a.location.href)},Ma={options:{recursionWarningCount:5,recursionThrowCount:10},state:{get currentRoute(){return Ka},navigation:{get inProgress(){return Ia},get pendingRoute(){return Ha}}},addHook(a,b,c=null,d=!1){a=K(a).relativeRoute,za.has(a)||za.set(a,[]),P(za.get(a),b,c,d)},beforeEach(a,b=null,c=!1){P(Aa,a,b,c)},afterEach(a,b=null,c=!1){P(Ba,a,b,c)},subscribe(b,c){if(!c)throw new Error("Router.subscribe requires second parameter to be \"options\" object or \"onRoute\" handler function.");else if("function"==typeof c){const a=c;c={onRoute:a}}else if("function"!=typeof c.beforeRoute&&"function"!=typeof c.onRoute)throw new Error("Router.subscribe requires \"options\" object with \"beforeRoute\", \"onRoute\" or both handler functions.");if(b=K(b).relativeRoute,wa.has(b))throw new Error("Router already has an active subscription for \""+b+"\".");else wa.add(b);const d=ya[ta]=ya[ta]||{beforeRoute:void 0,onRoute:void 0,children:{}};if(b===ta)d.beforeRoute=c.beforeRoute,d.onRoute=c.onRoute;else{const a=b.split("/"),e=a[a.length-1];a.reduce((a,b)=>a[b]?(b===e&&(a[b].beforeRoute=c.beforeRoute,a[b].onRoute=c.onRoute),a[b].children):(a[b]={beforeRoute:b===e?c.beforeRoute:void 0,onRoute:b===e?c.onRoute:void 0,children:{}}).children,d.children)}if(!1===Ja){Ja=!0;const b=b=>{Ma.navigate(a.location.href,!1,b).then(b=>{a.history.replaceState(null,document.title,b)})};"complete"===document.readyState?b(!0):document.addEventListener("readystatechange",()=>{"complete"===document.readyState&&b(!0)}),a.addEventListener("hashchange",()=>{b(!1)})}},navigate(b,c=!0,d=!1){const e=b.split(/\?(.+)/).filter(a=>a),{relativeRoute:f,absoluteRoute:g}=K(e.shift()),h=e[0]?`?${e[0]}`:a.location.search;if(za.has(f)){const a={};if(1<h.length){const b=h.substring(1).replace(/\+/g," ").replace(/;/g,"&").split("&");for(let c,d,e=0;e<b.length;e++)c=b[e].split("=",2),d=decodeURIComponent(c[0]),d&&(a[d]=!(1<c.length)||decodeURIComponent(c[1]))}Q(za.get(f),a)}return f===Ka&&!1===d?(Q(Aa,Ka,f),Q(Ba,Ka,f),La):Ia?(console.warn("Router.navigate to \""+g+"\" not executed because navigation to \""+Ha+"\" is still in progress."),La):(Ha=g,Ia=!0,(Q(Aa,Ka,f),new Promise(b=>{D(g).then(e=>{I(e).then(f=>{!1===d&&f===Ka?(Ia=!1,Q(Ba,Ka,f),b(f+h)):H(e).then(e=>{for(let a,b,c,f=0;f<e.length;f++)a=e[f],b=a[0],c=a[1],!0!==d&&xa.has(b)&&xa.get(b)===c||(b(c),xa.set(b,c));Ka=f,!0===c&&a.history.pushState(null,document.title,f+h),Ia=!1,Q(Ba,Ka,f),b(f+h)})})})})))}},Na={Component:sa,Store:ha,Server:V,Router:Ma};"object"==typeof module&&"object"==typeof module.exports?module.exports=Na:"function"==typeof define&&define.amd?define("Cue",[],function(){return Na}):a.Cue=Na})(window||this);