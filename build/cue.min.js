!function(e){const t=()=>{},n=Promise.resolve();function o(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(e.constructor!==t.constructor)return!1;let n;if(Array.isArray(e)){if(e.length!==t.length)return!1;for(n=e.length;0!=n--;)if(!o(e[n],t[n]))return!1;return!0}const r=Object.keys(e),i=r.length;if(i!==Object.keys(t).length)return!1;for(n=i;0!=n--;)if(!Object.prototype.hasOwnProperty.call(t,r[n]))return!1;for(n=i;0!=n--;){const i=r[n];if(!o(e[i],t[i]))return!1}return!0}return e!=e&&t!=t}function r(e){if(!e||"object"!=typeof e)return e;if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++)t.push(r(e[n]));return t}const t=Object.keys(e),n={};for(let o,i=0;i<t.length;i++)o=t[i],n[o]=r(e[o]);return n}function i(e){if(!e.length)return 0;let t=0;for(let n,o=0;o<e.length;o++)n=e.charCodeAt(o),t=(t<<5)-t+n,t&=t;return t}const s=e.localStorage,a=new Map,c="CUE_SERVER_CACHE::KEYS",l=Symbol(),u={fetch:(e,t=0,n)=>new Promise((o,r)=>{const a=i(e),u=function(e){const t=s.getItem(e+"::ts");return null===t?l:Number(t)<Date.now()?(h(e),l):JSON.parse(s.getItem(e))}(a);u===l?f(e,"GET",n).then(e=>{t>0&&function(e,t,n){const o=Date.now()+1e3*n;"object"==typeof t&&(t=JSON.stringify(t));const r=e+"::ts";s.setItem(e,t),s.setItem(r,""+o);let i=s.getItem(c);null===i?i=`${e},${r},`:-1===i.indexOf(e+",")&&(i=`${i}${e},${r},`);s.setItem(c,i)}(a,e,t),o(e)}).catch(e=>{r(e)}):o(u)}),get(e,t=0,n){return this.fetch(e,t,n)},post:(e,t,n)=>new Promise((o,r)=>{f(e,"POST",n,t).then(e=>o(e)).catch(e=>r(e))}),put:(e,t,n)=>new Promise((o,r)=>{f(e,"PUT",n,t).then(e=>o(e)).catch(e=>r(e))}),delete:(e,t,n)=>new Promise((o,r)=>{f(e,"DELETE",n,t).then(e=>o(e)).catch(e=>r(e))}),clearCache(e){h(i(e))}};function h(e){if(e){if(null!==s.getItem(e)){const t=e+"::ts";s.removeItem(e),s.removeItem(t);const n=s.getItem(c);if(null!==n){const o=n.split(",");o.splice(o.indexOf(e),1),o.splice(o.indexOf(t),1),s.setItem(c,o.join(",")+",")}}}else{const e=s.getItem(c);if(null!==e){const t=e.split(",");for(let e=0;e<t.length;e++)s.removeItem(t[e]);s.removeItem(c)}}}function f(e,t,n,o={}){if(a.has(e))return a.get(e);{const r={"Content-Type":"application/json"};return n&&(r.Authorization="Bearer "+n),a.set(e,new Promise((n,i)=>{fetch(e,{method:t,mode:"cors",cache:"no-store",credentials:"same-origin",headers:r,redirect:"follow",referrer:"no-referrer",body:"GET"===t?null:"string"==typeof o?o:JSON.stringify(o)}).then(e=>{e.ok?204===e.status?n({}):e.json().then(e=>n(e)):e.json().then(e=>i(e))}).catch(e=>{i(e)}).finally(()=>{a.delete(e)})})),a.get(e)}}let d=null,p=null,g=!1;const m=new Map,b=new Map,y=new Map,v=new Map,w=[],R={cueEvent(e,t){m.set(e,t)},cueCallback(e,t){b.set(e,t)},cueComputations(e,t,n,o){const r=e.get(n),i=[e,t,o];for(let e=0;e<r.length;e++)y.set(r[e],i)},react:()=>d||(d=new Promise(C))};function C(e){!1===g&&(p=e,requestAnimationFrame(x))}function x(){let e,t,n,o,r,i,s,a;for(t of(g=!0,m.entries()))t[0](t[1]);for(;y.size>0;){for(t of y.entries())o=t[0],-1===w.indexOf(o)&&(r=t[1],s=r[0],i=r[1],o.needsUpdate=!0,a=o.value(r[2]),!0===o.hasChanged&&(i[o.ownPropertyName]&&b.set(i[o.ownPropertyName],a),v.set(o,r)),w.push(o));for(t of(y.clear(),v.entries()))if(o=t[0],r=t[1],n=r[0].get(o.ownPropertyName),n)for(e=0;e<n.length;e++)y.set(n[e],r);v.clear()}for(t of b.entries())t[0](t[1]);for(m.clear(),b.clear();w.length>0;)w.pop();g=!1,p(),p=null,d=null}const P=new Map,j=new Map,E={id:Symbol("Cue.Store"),get(e){if(!e){const e={};for(const t of P.entries())e[t[0]]=r(t[1]);return e}return r(P.get(e))},set(e,t){if(e&&"object"==typeof e){let t=n;for(const n in e)o(P.get(n),e[n])||(t=S(n,e[n]));return t}return o(P.get(e),t)?n:S(e,t)},has:e=>P.has(e),remove:e=>P.has(e)?(P.delete(e),T(e,void 0)):(console.warn(`Can't remove Store entry "${e}" because it doesn't exist.`),n),clear(e=!1){if(0===P.size)return n;if(!0===e)return P.clear(),n;const t=P.keys();P.clear();const o=[];for(const e of t)o.push(T(e,void 0));return Promise.all(o)},bind(e){return{id:this.id,key:e}},subscribe(e,t,n={}){const o=Object.assign({autorun:!1},n,{handler:n.scope?t.bind(n.scope):t});return j.has(e)?j.get(e).push(o):j.set(e,[o]),!0===o.autorun&&(P.has(e)?T(e,P.get(e)):console.warn(`Can not autorun Store subscription because "${e}" is not set.`)),{unsubscribe:()=>{const t=j.get(e);t.splice(t.indexOf(o),1)}}}};function O(e){return P.get(e)}function S(e,t){return P.set(e,t),T(e,t)}function T(e,t){const o=j.get(e);if(o){for(let e=0;e<o.length;e++)R.cueEvent(o[e].handler,t);return R.react()}return n}const k={computedProperty:null,computedProperties:null};let I=null,M=[];class N{constructor(e,t,n=[]){this.ownPropertyName=e,this.computation=t,this.sourceProperties=n,this.intermediate=void 0,this._value=void 0,this._type=-1,this.needsUpdate=!0,this.hasChanged=!1}value(e){return!0===this.needsUpdate&&(this.intermediate=this.computation.call(e,e,this._value),Array.isArray(this.intermediate)?(this.hasChanged=1!==this._type||!function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(this._value,this.intermediate))&&(this._value=this.intermediate.slice(),this._type=1):"object"==typeof this.intermediate&&null!==this.intermediate?(this.hasChanged=2!==this._type||!function(e,t){const n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(let r,i=0;i<n.length;i++)if(r=n[i],-1===o.indexOf(r)||e[r]!==t[r])return!1;return!0}(this._value,this.intermediate))&&(this._value=Object.assign({},this.intermediate),this._type=2):(this.hasChanged=this._value!==this.intermediate)&&(this._value=this.intermediate,this._type=0),this.needsUpdate=!1),this._value}}function _(e,t){return function(e){I=e;const t=new Map;let n;for(n of e.keys())A(n,[],t);return I=null,M=[],t}(function(e,t){Object.assign(k,{computedProperties:t});const n=new Proxy(e,{get:$});let o;for(o of t.values()){k.computedProperty=o;try{o.computation.call(n,n)}catch(e){if(e.type&&"cue-internal"===e.type)throw new Error(e.message)}}return k.computedProperty=null,k.computedProperties=null,t}(e,t))}function $(e,t){const{computedProperty:n}=k;if(!e.hasOwnProperty(t))throw{type:"cue-internal",message:`Cannot resolve computed property "${n.ownPropertyName}" because dependency "${t}" doesn't exist.`};-1===n.sourceProperties.indexOf(t)&&n.sourceProperties.push(t)}function A(e,t,n){if(I.has(e)){t.push(e),M.push(e);const o=I.get(e);for(let e,r=0;r<o.sourceProperties.length;r++){if(e=o.sourceProperties[r],-1!==t.indexOf(e))throw new Error(`Circular dependency. "${o.ownPropertyName}" is required by "${e}": ${t.join(" -> ")}`);-1===M.indexOf(e)&&A(e,t,n)}n.has(e)||n.set(e,o)}}const L=/(\$self(?=[\\040{.:#[>+~]))|\$self\b/g,z=[" ",".",":","#","[",">","+","~"];let H=-1;const q=Symbol("Component Data"),U=document.createElement("div"),D={compiler:document.getElementById("cue::compiler")||Object.assign(document.head.appendChild(document.createElement("style")),{id:"cue::compiler"}),components:document.getElementById("cue::components")||Object.assign(document.head.appendChild(document.createElement("style")),{id:"cue::components"})},B={define(e,i){let s=!1,a=!1;const c={initialize:t,connected:t,disconnected:t},l={static:{},computed:new Map,bindings:{},reactions:{}},u=document.createElement("template");u.innerHTML=i.element||"";const h=function e(t,n){for(let o,r,i,s,a=0;a<t.children.length;a++)o=t.children[a],r=o.getAttribute("$"),r&&(i=o.getAttribute("class"),s=r+ ++H,n["$"+r]="."+s,o.setAttribute("class",i?i+" "+s:s),o.removeAttribute("$")),e(o,n);return n}(u.content,{}),f=class extends HTMLElement{constructor(){super(),this[q]={reactions:{},computedProperties:new Map,subscriptions:[],refs:{},_data:{},initialized:!1,dataEvent:new CustomEvent("data",{bubbles:!0,cancelable:!0,detail:{key:"",value:void 0}})},!1===s&&(s=!0,"string"==typeof i.styles&&i.styles.length&&function(e,t,n){t=t.replace(L,e);for(const e in n)t=t.replace(new RegExp("(\\"+e+"(?=[\\40{.:#[>+~]))|\\"+e+"\b","g"),n[e]);D.compiler.innerHTML=t;const o=D.compiler.sheet;let r="",i="";for(let t,n=0;n<o.rules.length;n++)t=o.rules[n],7===t.type||8===t.type?r+=t.cssText:1===t.type?r+=J(t,e):4===t.type||12===t.type?i+=G(e,t):console.warn(`CSS Rule of type "${t.type}" is not currently supported by Cue Components.`);r+=i,D.compiler.innerHTML="",D.components.innerHTML+=r}(e,i.styles,h),"function"==typeof i.initialize&&(c.initialize=i.initialize),"function"==typeof i.connectedCallback&&(c.connected=i.connectedCallback),"function"==typeof i.disconnectedCallback&&(c.disconnected=i.disconnectedCallback))}connectedCallback(){if(!1===a){a=!0;const e={};if(i.data){i.data="function"==typeof i.data?i.data():i.data;for(const t in i.data){const n=i.data[t];e[t]=n.value,n.value&&n.value.id===E.id?l.bindings[t]=n.value:"function"==typeof n.value?l.computed.set(t,new N(t,n.value)):l.static[t]=n.value,"function"==typeof n.reaction&&(l.reactions[t]=n.reaction)}}l.computed.size>0&&(l.computed=_(e,l.computed))}const e=this[q];if(!1===e.initialized){e.initialized=!0;const t=e._data=Object.assign(r(l.static),e._data),n=e.computedProperties;e.data=new Proxy(t,{set:W,get:(t,o)=>l.bindings[o]?r(O(l.bindings[o].key)):n.has(o)?n.get(o).value(e.data):r(t[o])});for(const e of l.computed.entries()){const t=e[1];n.set(e[0],new N(t.ownPropertyName,t.computation,t.sourceProperties))}e.dependencyGraph=function(e){const t=new Map;let n,o,r;for(n of e.values())for(o=0;o<n.sourceProperties.length;o++)r=n.sourceProperties[o],t.has(r)?t.get(r).push(n):t.set(r,[n]);return t}(e.computedProperties);for(const t in l.reactions)e.reactions[t]=n=>{l.reactions[t](e.refs,n,e.data)};0===this.innerHTML.length&&(this.innerHTML=u.innerHTML);for(const t in h){const n=this.querySelector(h[t]);n&&(n[q]||(n[q]={},n.renderEach=Y),e.refs[t]=n)}if(e.refs.$self=this,this.hasAttribute("data")){const t=JSON.parse(this.getAttribute("data"));this.removeAttribute("data"),Object.assign(e._data,t)}for(const t in e.reactions)R.cueCallback(e.reactions[t],e.data[t]);R.react().then(()=>{c.initialize.call(this,e.refs),c.connected.call(this,e.refs)})}else c.connected.call(this,e.refs);for(const t in l.bindings)e.dependencyGraph.has(t)&&e.subscriptions.push(E.subscribe(l.bindings[t].key,()=>R.cueComputations(e.dependencyGraph,e.reactions,t,e.data),{autorun:!1})),e.reactions[t]&&e.subscriptions.push(E.subscribe(l.bindings[t].key,e.reactions[t],{autorun:!1}))}disconnectedCallback(){const e=this[q],t=e.subscriptions;for(;t.length;)t.pop().unsubscribe();c.disconnected.call(this,e.refs)}getData(e){if(!e){const e=this[q],t={};let n;for(n in l.bindings)t[n]=E.get(l.bindings[n].key);for(n in e._data)t[n]=r(e._data[n]);return t}return this[q].data[e]}setData(e,t){if("object"==typeof e){let t=n;for(const n in e)t=this.setData(n,e[n]);return t}if(l.computed.has(e))throw new Error(`You can not set property "${e}" because it is a computed property.`);const i=this[q];if(l.bindings[e]&&!o(O(l.bindings[e].key),t))return i.dataEvent.detail.key=e,i.dataEvent.detail.value=r(t),this.dispatchEvent(i.dataEvent),S(l.bindings[e].key,t);if(!o(i._data[e],t)){i._data[e]=t,i.dataEvent.detail.key=e,i.dataEvent.detail.value=r(t),this.dispatchEvent(i.dataEvent);let o=!1;return i.reactions[e]&&(R.cueCallback(i.reactions[e],t),o=!0),i.dependencyGraph.has(e)&&(R.cueComputations(i.dependencyGraph,i.reactions,e,i.data),o=!0),o?R.react():n}}};for(const e in i)"function"==typeof i[e]&&"initialize"!==e&&(f.prototype[e]=i[e]);f.prototype.renderEach=Y,customElements.define(e,f);const d="<"+e,p="</"+e+">";return e=>{let t,n,o=d;for(t in e)n=e[t],n=n&&"object"==typeof n?JSON.stringify(n):n,o+=` ${t}='${n}'`;return o+=">"+u.innerHTML+p,o}},create(e,t){if("string"!=typeof(e=(e="function"==typeof e?e():e).trim())||"<"!==e[0])throw new Error('[Cue.js] - Component.create(node) -> argument "node" is not valid HTML: "'+e+'"');U.innerHTML=e;const n=U.children[0];if(t){console.warn("[Cue.js] - Component.create(...) [data] parameter will be deprecated in a future version. Pass data object as an attribute to the components factory function instead.");const e=n[q];e?Object.assign(e._data,r(t)):console.warn("[Cue.js] - Component.create(...) [data] parameter passed to non-cue element will be ignored.")}return n}};function G(e,t,n=""){4===t.type?n+="@media "+t.media.mediaText+" {":n+="@supports "+t.conditionText+" {";let o="";for(let r,i=0;i<t.cssRules.length;i++)r=t.cssRules[i],7===r.type||8===r.type?n+=r.cssText:1===r.type?n+=J(r,e):4===r.type||12===r.type?o+=G(e,r):console.warn(`CSS Rule of type "${r.type}" is not currently supported by Components.`);return n+=o+" }"}function J(e,t){let n="";if(e.selectorText.indexOf(",")>-1){const o=e.selectorText.split(","),r=[];for(let e,n=0;n<o.length;n++)e=o[n].trim(),0===e.lastIndexOf(":root",0)?r.push(e.replace(":root","")):Q(e,t)?r.push(e):r.push(t+" "+e);n+=r.join(", ")+e.cssText.substr(e.selectorText.length)}else 0===e.selectorText.lastIndexOf(":root",0)?n+=e.cssText.replace(":root",""):Q(e.selectorText,t)?n+=e.cssText:n+=t+" "+e.cssText;return n}function Q(e,t){return e===t||0===e.lastIndexOf(t,0)&&z.indexOf(e.charAt(t.length))>-1}function W(e,t,n){throw new Error(`Can not change data in reactions: this.${t} = ${n} has been ignored.`)}function Y(e,n,o=t){e=Array.isArray(e)?e:Object.values(e||{});const r=this[q].childData||[];if(this[q].childData=e,0===e.length)this.innerHTML="";else if(0===r.length)for(let t=0;t<e.length;t++)this.appendChild(n(e[t],t,e));else!function(e,t,n,o,r){let i,s,a,c=0,l=0,u=!0,h=t.length-1,f=n.length-1,d=e.firstChild,p=d,g=e.lastChild,m=g;e:for(;u;){let o;for(u=!1,i=t[c],s=n[l];i===s;){if(r(d,s),c++,l++,p=d=d.nextSibling,h<c||f<l)break e;i=t[c],s=n[l]}for(i=t[h],s=n[f];i===s;){if(r(g,s),h--,f--,a=g,m=g=g.previousSibling,h<c||f<l)break e;i=t[h],s=n[f]}for(i=t[h],s=n[l];i===s;){if(u=!0,r(g,s),o=g.previousSibling,e.insertBefore(g,p),m=g=o,l++,h--,h<c||f<l)break e;i=t[h],s=n[l]}for(i=t[c],s=n[f];i===s;){if(u=!0,r(d,s),o=d.nextSibling,e.insertBefore(d,a),a=m=d,d=o,c++,f--,h<c||f<l)break e;i=t[c],s=n[f]}}if(f<l){if(c<=h){let t;for(;c<=h;)0===h?e.removeChild(g):(t=g.previousSibling,e.removeChild(g),g=t),h--}return}if(h<c){if(l<=f)for(;l<=f;)a?e.insertBefore(o(n[l],l,n),a):e.appendChild(o(n[l],l,n)),l++;return}const b=new Array(f+1-l),y=new Map;let v;for(v=l;v<=f;v++)b[v]=-1,y.set(n[v],v);let w=0,R=[];for(v=c;v<=h;v++)y.has(t[v])?(b[y.get(t[v])]=v,w++):R.push(v);if(0===w){for(e.textContent="",v=l;v<=f;v++)e.appendChild(o(n[v],v,n));return}const C=function(e,t){const n=[],o=[],r=new Array(e.length);let i,s,a,c=-1;for(i=t;i<e.length;i++){if(s=e[i],s<0)continue;let t,l=-1,u=n.length;if(u>0&&n[u-1]<=s)a=u-1;else{for(;u-l>1;)t=Math.floor((l+u)/2),n[t]>s?u=t:l=t;a=l}-1!==a&&(r[i]=o[a]),a===c?(c++,n[c]=s,o[c]=i):s<n[a+1]&&(n[a+1]=s,o[a+1]=i)}for(i=o[c];c>=0;i=r[i],c--)n[c]=i;return n}(b,l),x=[];let P=d;for(v=c;v<=h;v++)x[v]=P,P=P.nextSibling;for(v=0;v<R.length;v++)e.removeChild(x[R[v]]);let j,E=C.length-1;for(v=f;v>=l;v--)C[E]===v?(a=x[b[C[E]]],r(a,n[v]),E--):(-1===b[v]?j=o(n[v],v,n):(j=x[b[v]],r(j,n[v])),e.insertBefore(j,a),a=j)}(this,r,e,n,o)}const F=e.location.origin+e.location.pathname,K=[F,e.location.hostname,e.location.hostname+"/",e.location.origin];"/"!==F[F.length-1]&&K.push(F+"/"),e.location.pathname&&"/"!==e.location.pathname&&K.push(e.location.pathname);const V=["/","#","/#","/#/",...K],X=new Set,Z=new Set,ee=new Map,te=new Map,ne={},oe={params:{},keepQuery:!0,revertible:!0,forceReload:!1},re={then:t=>t(e.location.href)};let ie=0,se=null,ae=!1,ce=null,le=!1,ue={},he=!1,fe=!1,de="",pe=null;const ge={options:{recursionWarningCount:5,recursionThrowCount:10,defer:50},hook(e,t,n=null,o=!1){const r=we(e).hash;ee.has(r)||ee.set(r,[]);const i=ee.get(r);let s;s=!1===o?t.bind(n):e=>{t.call(n,e);const o=i.indexOf(s);i.splice(o,1)},i.push(s)},trigger(t,n={}){n=Object.assign({},oe,n);const{hash:o,query:r}=we(t),i=ee.get(o);if(i&&i.length){const t=!r&&n.keepQuery?e.location.search:r,o=Object.assign(Ce(t),n.params);for(let e=0;e<i.length;e++)i[e](o)}},subscribe(t,n){if(!n)throw new Error('Router.subscribe requires second parameter to be "options" object or "onRoute" handler function.');if("function"==typeof n){n={onRoute:n}}else if("function"!=typeof n.beforeRoute&&"function"!=typeof n.onRoute)throw new Error('Router.subscribe requires "options" object with "beforeRoute", "onRoute" or both handler functions.');if("*"===t)return void Z.add(n.onRoute);const o=we(t).hash,r="#"===o;if(X.has(o))throw new Error("root");X.add(o);const i=ne[F]=ne[F]||{beforeRoute:void 0,onRoute:void 0,children:{}};if(r)i.beforeRoute=n.beforeRoute,i.onRoute=n.onRoute;else{const e=o.split("/"),t=e[e.length-1];e.reduce((e,o)=>e[o]?(o===t&&(e[o].beforeRoute=n.beforeRoute,e[o].onRoute=n.onRoute),e[o].children):(e[o]={beforeRoute:o===t?n.beforeRoute:void 0,onRoute:o===t?n.onRoute:void 0,children:{}}).children,i.children)}!1!==n.autorun&&ge.navigate(e.location.href,{revertible:!1,forceReload:!0}).then(t=>{e.history.replaceState(null,document.title,t)}),!1===fe&&(fe=!0,e.addEventListener("popstate",()=>{ge.navigate(e.location.href,{revertible:!1,forceReload:!1}).then(t=>{e.history.replaceState(null,document.title,t)})}))},navigate:(e,t={})=>(t=Object.assign({},oe,t),ge.options.defer>0?new Promise(n=>{clearTimeout(pe),pe=setTimeout(()=>{me(e,t).then(e=>n(e)),pe=null},ge.options.defer)}):me(e,t))};function me(t,n){const{abs:o,hash:r,query:i}=we(t),s=!i&&n.keepQuery?e.location.search:i;ue=Object.assign(Ce(s),n.params);const a=ee.get(r);if(a)for(let e=0;e<a.length;e++)a[e](ue);return o===de&&!1===n.forceReload?re:he?(console.warn('Router.navigate to "'+t+'" not executed because another navigation is still in progress.'),re):(he=!0,new Promise(t=>{var r;(r=o,new Promise(e=>{ie=0,ae=!1,ce=null,se=e,le=!1,ne[F]||se(null),be(r)})).then(o=>{(function e(t,n=""){return new Promise(o=>{null===t||"/"===t.value?o(n):Promise.resolve(t.nextNode).then(r=>{n+=0===n.length||t.value===F||"#"===t.value[0]?t.value:"/"+t.value,o(e(r,n))})})})(o).then(r=>{const i=new URL(r);i.search=s;const a=i.toString();r===de&&!1===n.forceReload?(he=!1,t(a)):function e(t,n=[]){return new Promise(o=>{null===t.nextNode&&o(n),Promise.resolve(t.nextNode).then(r=>{null!==r&&(t.onRoute&&n.push([t.onRoute,r.value]),o(e(r,n)))})})}(o).then(o=>{for(let e,t,r,i=0;i<o.length;i++)e=o[i],t=e[0],r=e[1],!0!==n.forceReload&&te.has(t)&&te.get(t)===r||(t(r,ue),te.set(t,r));Z.forEach(e=>e(a,ue)),de=r,!0===n.revertible&&e.history.pushState(null,document.title,a),he=!1,t(a)})})})}))}function be(e){if(e===F)null!==ce?se(ce):ye(ne,[F]).then(e=>{ce=e,!1===le&&(le=!0,se(ce))});else if(0===e.lastIndexOf(F,0)){const t=e.substr(F.length);if("#"!==t[0])throw new Error('Invalid route "'+t+'". Nested routes must be hash based.');null!==ce?ye(ne.children,t.split("/")).then(e=>{!1===le&&(le=!0,se(Object.assign(ce,{nextNode:e})))}):ye(ne,[F,...t.split("/")]).then(e=>{ce=e,!1===le&&(le=!0,se(ce))})}else"#"===e[0]&&ye(ne[F].children,e.split("/")).then(e=>{!1===le&&(le=!0,se(Object.assign(ce,{nextNode:e})))})}function ye(e,t,n=""){return new Promise(o=>{const r=t[0],i=e[r];if(!i||ae)o({value:t.length&&n.length?("/"===n[n.length-1]?n:n+"/")+t.join("/"):t.length?t.join("/"):n.length?n:"/",nextNode:null});else{n+=0===n.length||"/"===n[n.length-1]?r:"/"+r;const s=t.slice(1);if(i.beforeRoute){const a=function e(t,n,o=""){const r=n[0],i=t[r];if(!i)return n.length&&o.length?o+"/"+n.join("/"):n.length?n.join("/"):o.length?o:"/";if(o+=0===o.length?r:"/"+r,i.beforeRoute||i.onRoute)return o;return e(i.children,n.slice(1),o)}(i.children,s);Promise.resolve(i.beforeRoute(a,ue)).then(c=>{if(c="string"==typeof c?function(e){const t=Re(e,K);return t?e.replace(t,F):e}(function(e){e.length>1&&"/"===e[0]&&(e=e.substr(1));e.length>1&&"/"===e[e.length-1]&&(e=e.slice(0,-1));return e}(c)):a,a===c)o({value:n,onRoute:i.onRoute,nextNode:ye(i.children,s)});else if(r===F){if("/"!==a&&"#"!==a[0])throw new Error('Invalid Route Setup: "'+a+'" can not directly follow root url. Routes at this level must start with a #.');if("#"!==c[0])throw new Error('Invalid Route "'+c+'" returned from beforeRoute. Routes at this level must start with a #.');o({value:n,onRoute:i.onRoute,nextNode:ye(i.children,c.split("/"))})}else"#"===r[0]?"/"===a?o({value:n,onRoute:i.onRoute,nextNode:ye(i.children,c.split("/"))}):"/"===c||"#"===c[0]?ve(t)&&o(ye(e,c.split("/"))):o({value:n,onRoute:i.onRoute,nextNode:ye(i.children,c.split("/"))}):c===F||"#"===c[0]||0===c.lastIndexOf(F,0)?ve(t)&&be(c):o({value:n,onRoute:i.onRoute,nextNode:ye(i.children,c.split("/"))})})}else i.onRoute?o({value:n,onRoute:i.onRoute,nextNode:ye(i.children,s)}):o(ye(i.children,s,n))}})}function ve(e){if(ie++,ie===ge.options.recursionThrowCount)throw ae=!0,new Error('Router.navigate is causing potentially infinite route rewrites at "'+e.join("/")+'". Stopped execution after '+ge.options.recursionThrowCount+" cycles...");return ie===ge.options.recursionWarningCount&&console.warn("Router.navigate is causing more than "+ge.options.recursionWarningCount+" route rewrites..."),!0}function we(e){if(V.indexOf(e)>-1)return{abs:F,hash:"#",query:""};if("?"===e[0]||"#"===e[0]){const t=new URL(e,F);return{abs:F+t.hash,hash:t.hash||"#",query:t.search}}if("?"!==(e=function(e){const t=Re(e,V);return t?e.substr(t.length):e}(e))[0]&&"#"!==e[0])throw new Error('Invalid Route: "'+e+'". Non-root paths must start with ? query or # hash.');const t=new URL(e,F);return{abs:F+t.hash,hash:t.hash||"#",query:t.search}}function Re(e,t){return t.filter(t=>0===e.lastIndexOf(t,0)).sort((e,t)=>t.length-e.length)[0]}function Ce(e){const t={};if(e.length>1){const n=e.substring(1).replace(/\+/g," ").replace(/;/g,"&").split("&");for(let e,o,r=0;r<n.length;r++)e=n[r].split("=",2),o=decodeURIComponent(e[0]),o&&(t[o]=!(e.length>1)||decodeURIComponent(e[1]))}return t}const xe={Component:B,Store:E,Server:u,Router:ge};"object"==typeof module&&"object"==typeof module.exports?module.exports=xe:"function"==typeof define&&define.amd?define("Cue",[],(function(){return xe})):e.Cue=xe}(window||this);