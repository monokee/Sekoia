!function(e){const t=()=>{},n=Promise.resolve();function o(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(e.constructor!==t.constructor)return!1;let n;if(Array.isArray(e)){if(e.length!==t.length)return!1;for(n=e.length;0!=n--;)if(!o(e[n],t[n]))return!1;return!0}const r=Object.keys(e),i=r.length;if(i!==Object.keys(t).length)return!1;for(n=i;0!=n--;)if(!Object.prototype.hasOwnProperty.call(t,r[n]))return!1;for(n=i;0!=n--;){const i=r[n];if(!o(e[i],t[i]))return!1}return!0}return e!=e&&t!=t}function r(e){if(!e||"object"!=typeof e)return e;if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++)t.push(r(e[n]));return t}const t=Object.keys(e),n={};for(let o,i=0;i<t.length;i++)o=t[i],n[o]=r(e[o]);return n}function i(e){if(!e.length)return 0;let t=0;for(let n,o=0;o<e.length;o++)n=e.charCodeAt(o),t=(t<<5)-t+n,t&=t;return t}const s=e.localStorage,c=new Map,l="CUE_SERVER_CACHE::KEYS",a=Symbol(),u={fetch:(e,t=0,n)=>new Promise((o,r)=>{const c=i(e),u=function(e){const t=s.getItem(e+"::ts");return null===t?a:Number(t)<Date.now()?(h(e),a):JSON.parse(s.getItem(e))}(c);u===a?f(e,"GET",n).then(e=>{t>0&&function(e,t,n){const o=Date.now()+1e3*n;"object"==typeof t&&(t=JSON.stringify(t));const r=e+"::ts";s.setItem(e,t),s.setItem(r,""+o);let i=s.getItem(l);null===i?i=`${e},${r},`:-1===i.indexOf(e+",")&&(i=`${i}${e},${r},`);s.setItem(l,i)}(c,e,t),o(e)}).catch(e=>{r(e)}):o(u)}),get(e,t=0,n){return this.fetch(e,t,n)},post:(e,t,n)=>new Promise((o,r)=>{f(e,"POST",n,t).then(e=>o(e)).catch(e=>r(e))}),put:(e,t,n)=>new Promise((o,r)=>{f(e,"PUT",n,t).then(e=>o(e)).catch(e=>r(e))}),delete:(e,t,n)=>new Promise((o,r)=>{f(e,"DELETE",n,t).then(e=>o(e)).catch(e=>r(e))}),clearCache(e){h(i(e))}};function h(e){if(e){if(null!==s.getItem(e)){const t=e+"::ts";s.removeItem(e),s.removeItem(t);const n=s.getItem(l);if(null!==n){const o=n.split(",");o.splice(o.indexOf(e),1),o.splice(o.indexOf(t),1),s.setItem(l,o.join(",")+",")}}}else{const e=s.getItem(l);if(null!==e){const t=e.split(",");for(let e=0;e<t.length;e++)s.removeItem(t[e]);s.removeItem(l)}}}function f(e,t,n,o={}){if(c.has(e))return c.get(e);{const r={"Content-Type":"application/json"};return n&&(r.Authorization="Bearer "+n),c.set(e,new Promise((n,i)=>{fetch(e,{method:t,mode:"cors",cache:"no-store",credentials:"same-origin",headers:r,redirect:"follow",referrer:"no-referrer",body:"GET"===t?null:"string"==typeof o?o:JSON.stringify(o)}).then(e=>{e.ok?204===e.status?n({}):e.json().then(e=>n(e)):e.json().then(e=>i(e))}).catch(e=>{i(e)}).finally(()=>{c.delete(e)})})),c.get(e)}}let p=null,d=null,g=!1;const m=new Map,b=new Map,y=new Map,w=new Map,v=[],R={cueEvent(e,t){m.set(e,t)},cueCallback(e,t){b.set(e,t)},cueComputations(e,t,n,o){const r=e.get(n),i=[e,t,o];for(let e=0;e<r.length;e++)y.set(r[e],i)},react:()=>p||(p=new Promise(C))};function C(e){!1===g&&(d=e,requestAnimationFrame(x))}function x(){let e,t,n,o,r,i,s,c;for(t of(g=!0,m.entries()))t[0](t[1]);for(;y.size>0;){for(t of y.entries())o=t[0],-1===v.indexOf(o)&&(r=t[1],s=r[0],i=r[1],o.needsUpdate=!0,c=o.value(r[2]),!0===o.hasChanged&&(i[o.ownPropertyName]&&b.set(i[o.ownPropertyName],c),w.set(o,r)),v.push(o));for(t of(y.clear(),w.entries()))if(o=t[0],r=t[1],n=r[0].get(o.ownPropertyName),n)for(e=0;e<n.length;e++)y.set(n[e],r);w.clear()}for(t of b.entries())t[0](t[1]);for(m.clear(),b.clear();v.length>0;)v.pop();g=!1,d(),d=null,p=null}const P=new Map,j=new Map,O=Object.defineProperty({get(e){if(!e){const e={};for(const t of P.entries())e[t[0]]=r(t[1]);return e}const t=e.split("/"),n=P.get(t[0]);if(void 0!==n){if(t.length>1){const[e,o]=E(n,t);return r(e[o])}return r(n)}},set(e,t){if(e&&"object"==typeof e){let t=!1;for(const n in e){const r=n.split("/"),i=P.get(r[0]),s=e[n];if(r.length>1){const[e,c]=E(i,r);o(e[c],s)||(t=!0,e[c]=s,T(n,s,r,i))}else void 0!==i&&o(i,s)||(t=!0,P.set(n,s),S(n,s))}return t?R.react():n}const r=e.split("/"),i=P.get(r[0]);if(r.length>1){const[s,c]=E(i,r);return o(s[c],t)?n:(s[c]=t,T(e,t,r,i))}return void 0!==i&&o(i,t)?n:(P.set(e,t),S(e,t))},has(e){const t=e.split("/"),n=P.get(t[0]);if(P.has(t[0])){if(t.length>1)try{return E(n,t),!0}catch(e){return!1}return!0}return!1},remove(e){const t=e.split("/"),o=P.get(t[0]);if(void 0===o)return console.warn(`Can't remove Store entry "${e}" because it doesn't exist.`),n;if(t.length>1){const[n,r]=E(o,t);return Array.isArray(n)?n.splice(parseInt(r),1):delete n[r],T(e,void 0,t,o)}return P.delete(t[0]),S(e,void 0)},clear(e={silently:!1}){if(0===P.size)return n;if(!0===e.silently)return P.clear(),n;const t=P.keys();P.clear();const o=[];for(const e of t)o.push(S(e,void 0));return Promise.all(o)},bind(e,t){const n={id:this.id,path:e};return 1===arguments.length?n:Object.assign(n,{defaultValue:t})},subscribe(e,t,n={}){if("string"!=typeof e||"function"!=typeof t||null===n||"object"!=typeof n)throw new Error("Invalid arguments. Expect (path:String, handler:Function, [options:Object]");const o=Object.assign({bubbles:!1,autorun:!0},n,{handler:n.scope?t.bind(n.scope):t});if(j.has(e)?j.get(e).push(o):j.set(e,[o]),!0===o.autorun){const t=e.split("/"),n=P.get(t[0]);let r=!1;if(void 0===n)r=!0;else if(t.length>1){const[e,o]=E(n,t);void 0===e[o]&&(r=!0)}if(!0===r)console.warn(`Can not auto-run Store subscription handler because value at "${e}" is undefined. Pass {autorun: false} option to avoid this warning.`);else if(!1===o.bubbles)S(e,P.get(e));else{const t=e.split("/");T(e,P.get(e),t,P.get(t[0]))}}return{unsubscribe(){const t=j.get(e);t.splice(t.indexOf(o),1),0===t.length&&j.delete(e)}}}},"id",{value:Symbol("Store ID")});function E(e,t){if(null!==e&&"object"==typeof e){let n,o;for(let r=1;r<t.length;r++)o=t[r],n=1===r?e:n[t[r-1]];if(n.hasOwnProperty(o))return[n,o];throw new Error(`Can not access store path: "${t.join("/")}". Property ".../${o}" does not exist.`)}throw new Error(`Can not access store path: "${t.join("/")}". The value stored at: "${t[0]}" is not object or array.`)}function S(e,t){const o=j.get(e);if(o){for(let e=0;e<o.length;e++)R.cueEvent(o[e].handler,t);return R.react()}return n}function T(e,t,o,r){const i=j.get(e);if(i){let e,n,s,c,l=!1;for(e=0;e<i.length;e++)if(!0===i[e].bubbles){l=!0;break}if(!0===l){const t=[];let i=o[0],l=r,a=j.get(i);if(a)for(e=0;e<a.length;e++)t.push([a[e],r]);for(e=1;e<o.length;e++)if(i+="/"+o[e],l=l[o[e]],a=j.get(i),a)for(n=0;n<a.length;n++)t.push([a[n],l]);for(e=t.length-1;e>=0;e--)s=t[e],c=s[0],R.cueEvent(s[0].handler,s[1])}else for(e=0;e<i.length;e++)R.cueEvent(i[e].handler,t);return R.react()}return n}const $={computedProperty:null,computedProperties:null};let I=null,k=[];class _{constructor(e,t,n=[]){this.ownPropertyName=e,this.computation=t,this.sourceProperties=n,this.intermediate=void 0,this._value=void 0,this._type=-1,this.needsUpdate=!0,this.hasChanged=!1}value(e){return!0===this.needsUpdate&&(this.intermediate=this.computation.call(e,e,this._value),Array.isArray(this.intermediate)?(this.hasChanged=1!==this._type||!function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(this._value,this.intermediate))&&(this._value=this.intermediate.slice(),this._type=1):"object"==typeof this.intermediate&&null!==this.intermediate?(this.hasChanged=2!==this._type||!function(e,t){const n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(let r,i=0;i<n.length;i++)if(r=n[i],-1===o.indexOf(r)||e[r]!==t[r])return!1;return!0}(this._value,this.intermediate))&&(this._value=Object.assign({},this.intermediate),this._type=2):(this.hasChanged=this._value!==this.intermediate)&&(this._value=this.intermediate,this._type=0),this.needsUpdate=!1),this._value}}function M(e,t){return function(e){I=e;const t=new Map;let n;for(n of e.keys())A(n,[],t);return I=null,k=[],t}(function(e,t){Object.assign($,{computedProperties:t});const n=new Proxy(e,{get:N});let o;for(o of t.values()){$.computedProperty=o;try{o.computation.call(n,n)}catch(e){if(e.type&&"cue-internal"===e.type)throw new Error(e.message)}}return $.computedProperty=null,$.computedProperties=null,t}(e,t))}function N(e,t){const{computedProperty:n}=$;if(!e.hasOwnProperty(t))throw{type:"cue-internal",message:`Cannot resolve computed property "${n.ownPropertyName}" because dependency "${t}" doesn't exist.`};-1===n.sourceProperties.indexOf(t)&&n.sourceProperties.push(t)}function A(e,t,n){if(I.has(e)){t.push(e),k.push(e);const o=I.get(e);for(let e,r=0;r<o.sourceProperties.length;r++){if(e=o.sourceProperties[r],-1!==t.indexOf(e))throw new Error(`Circular dependency. "${o.ownPropertyName}" is required by "${e}": ${t.join(" -> ")}`);-1===k.indexOf(e)&&A(e,t,n)}n.has(e)||n.set(e,o)}}const L=/\$self/g,z=[" ",".",":","#","[",">","+","~"];let H=-1;const q=Symbol("Component Data"),U=document.createElement("div"),D={compiler:Object.assign(document.head.appendChild(document.createElement("style")),{id:"cue::compiler"}),components:Object.assign(document.head.appendChild(document.createElement("style")),{id:"cue::components"})},G={define(e,i){let s=!1,c=!1;const l={initialize:t,connected:t,disconnected:t},a={static:{},computed:new Map,bindings:{},reactions:{}},u=document.createElement("template");u.innerHTML=i.element||"";const h=function e(t,n){for(let o,r,i,s,c=0;c<t.children.length;c++)o=t.children[c],r=o.getAttribute("$"),r&&(i=o.getAttribute("class"),s=r+ ++H,n["$"+r]="."+s,o.setAttribute("class",i?i+" "+s:s),o.removeAttribute("$")),e(o,n);return n}(u.content,{}),f=class extends HTMLElement{constructor(){super(),this[q]={reactions:{},computedProperties:new Map,subscriptions:[],refs:{},_data:{},initialized:!1},!1===s&&(s=!0,"string"==typeof i.styles&&i.styles.length&&function(e,t,n){t=t.replace(L,e);for(const e in n)t=t.replace(new RegExp("\\"+e,"g"),n[e]);D.compiler.innerHTML=t;const o=D.compiler.sheet;let r="",i="";for(let t,n=0;n<o.rules.length;n++)t=o.rules[n],7===t.type||8===t.type?r+=t.cssText:1===t.type?r+=V(t,e):4===t.type||12===t.type?i+=B(e,t):console.warn(`CSS Rule of type "${t.type}" is not currently supported by Cue Components.`);r+=i,D.compiler.innerHTML="",D.components.innerHTML+=r}(e,i.styles,h),"function"==typeof i.initialize&&(l.initialize=i.initialize),"function"==typeof i.connectedCallback&&(l.connected=i.connectedCallback),"function"==typeof i.disconnectedCallback&&(l.disconnected=i.disconnectedCallback))}connectedCallback(){if(!1===c){c=!0;const e={};if(i.data){i.data="function"==typeof i.data?i.data():i.data;for(const t in i.data){const n=i.data[t];e[t]=n.value,n.value&&n.value.id===O.id?a.bindings[t]=n.value:"function"==typeof n.value?a.computed.set(t,new _(t,n.value)):a.static[t]=n.value,"function"==typeof n.reaction&&(a.reactions[t]=n.reaction)}}a.computed.size>0&&(a.computed=M(e,a.computed))}const t=this[q];if(!1===t.initialized){t.initialized=!0;const n=t._data=Object.assign(r(a.static),t._data),o=t.computedProperties;t.data=new Proxy(n,{set:Q,get:(e,n)=>a.bindings[n]?O.get(a.bindings[n].path):o.has(n)?o.get(n).value(t.data):r(e[n])});for(const e of a.computed.entries()){const t=e[1];o.set(e[0],new _(t.ownPropertyName,t.computation,t.sourceProperties))}t.dependencyGraph=function(e){const t=new Map;let n,o,r;for(n of e.values())for(o=0;o<n.sourceProperties.length;o++)r=n.sourceProperties[o],t.has(r)?t.get(r).push(n):t.set(r,[n]);return t}(t.computedProperties);for(const e in a.reactions)t.reactions[e]=a.reactions[e].bind(t.data,t.refs);0===this.innerHTML.length&&(this.innerHTML=u.innerHTML);for(const e in h){const n=this.querySelector(h[e]);n[q]||(n[q]={},n.renderEach=W),t.refs[e]=n}t.refs.$self=this;for(const n in a.bindings){const o=a.bindings[n],r=o.path;if(O.has(r))t.reactions[n]&&R.cueCallback(t.reactions[n],O.get(r));else{if(!o.hasOwnProperty("defaultValue"))throw new Error(`Component data of "${e}" has property "${n}" bound to Store["${r}"] but Store has no value and component specifies no default.`);O.set(r,o.defaultValue)}}for(const e in t.reactions)R.cueCallback(t.reactions[e],t.data[e]);R.react().then(()=>{l.initialize.call(this,t.refs),l.connected.call(this,t.refs)})}else l.connected.call(this,t.refs);for(const e in a.bindings)t.dependencyGraph.has(e)&&t.subscriptions.push(O.subscribe(a.bindings[e].path,()=>R.cueComputations(t.dependencyGraph,t.reactions,e,t.data),{autorun:!1})),t.reactions[e]&&t.subscriptions.push(O.subscribe(a.bindings[e].path,t.reactions[e],{autorun:!1}))}disconnectedCallback(){const e=this[q],t=e.subscriptions;for(;t.length;)t.pop().unsubscribe();l.disconnected.call(this,e.refs)}getData(e){if(!e){const e=this[q],t={};let n;for(n in a.bindings)t[n]=O.get(a.bindings[n].path);for(n in e._data)t[n]=r(e._data[n]);return t}return this[q].data[e]}setData(e,t){if(1===arguments.length&&"object"==typeof e&&null!==e){const t=this[q];let r=!1;for(const n in e){const i=t._data[n],s=e[n];if(a.computed.has(n))throw new Error(`You can not set property "${n}" because it is a computed property.`);a.bindings[n]?(r=!0,O.set(a.bindings[n].path,s)):o(i,s)||(r=!0,t._data[n]=s,t.reactions[n]&&R.cueCallback(t.reactions[n],s),t.dependencyGraph.has(n)&&R.cueComputations(t.dependencyGraph,t.reactions,n,t.data))}return r?R.react():n}if(a.bindings[e])return O.set(a.bindings[e].path,t);if(a.computed.has(e))throw new Error(`You can not set property "${e}" because it is a computed property.`);const r=this[q];return o(r._data[e],t)?n:(r._data[e]=t,r.reactions[e]&&R.cueCallback(r.reactions[e],t),r.dependencyGraph.has(e)&&R.cueComputations(r.dependencyGraph,r.reactions,e,r.data),R.react())}};for(const e in i)"function"==typeof i[e]&&"initialize"!==e&&(f.prototype[e]=i[e]);f.prototype.renderEach=W,customElements.define(e,f);const p="<"+e,d="</"+e+">";return e=>{let t,n=p;for(t in e)n+=" "+t+'="'+e[t]+'"';return n+=">"+u.innerHTML+d,n}},create(e,t){let n;"<"===(e=e.trim())[0]?(U.innerHTML=e,n=U.children[0]):n=document.createElement(e);const o=n[q];return o&&t&&"object"==typeof t&&Object.assign(o._data,r(t)),n}};function B(e,t,n=""){4===t.type?n+="@media "+t.media.mediaText+" {":n+="@supports "+t.conditionText+" {";let o="";for(let r,i=0;i<t.cssRules.length;i++)r=t.cssRules[i],7===r.type||8===r.type?n+=r.cssText:1===r.type?n+=V(r,e):4===r.type||12===r.type?o+=B(e,r):console.warn(`CSS Rule of type "${r.type}" is not currently supported by Components.`);return n+=o+" }"}function V(e,t){let n="";if(e.selectorText.indexOf(",")>-1){const o=e.selectorText.split(","),r=[];for(let e,n=0;n<o.length;n++)e=o[n].trim(),0===e.lastIndexOf(":root",0)?r.push(e.replace(":root","")):J(e,t)?r.push(e):r.push(t+" "+e);n+=r.join(", ")+e.cssText.substr(e.selectorText.length)}else 0===e.selectorText.lastIndexOf(":root",0)?n+=e.cssText.replace(":root",""):J(e.selectorText,t)?n+=e.cssText:n+=t+" "+e.cssText;return n}function J(e,t){return e===t||0===e.lastIndexOf(t,0)&&z.indexOf(e.charAt(t.length))>-1}function Q(e,t,n){throw new Error(`Can not change data in reactions: this.${t} = ${n} has been ignored.`)}function W(e,n,o=t){e=Array.isArray(e)?e:Object.values(e||{});const r=this[q].childData||[];if(this[q].childData=e,0===e.length)this.innerHTML="";else if(0===r.length)for(let t=0;t<e.length;t++)this.appendChild(n(e[t],t,e));else!function(e,t,n,o,r){let i,s,c,l=0,a=0,u=!0,h=t.length-1,f=n.length-1,p=e.firstChild,d=p,g=e.lastChild,m=g;e:for(;u;){let o;for(u=!1,i=t[l],s=n[a];i===s;){if(r(p,s),l++,a++,d=p=p.nextSibling,h<l||f<a)break e;i=t[l],s=n[a]}for(i=t[h],s=n[f];i===s;){if(r(g,s),h--,f--,c=g,m=g=g.previousSibling,h<l||f<a)break e;i=t[h],s=n[f]}for(i=t[h],s=n[a];i===s;){if(u=!0,r(g,s),o=g.previousSibling,e.insertBefore(g,d),m=g=o,a++,h--,h<l||f<a)break e;i=t[h],s=n[a]}for(i=t[l],s=n[f];i===s;){if(u=!0,r(p,s),o=p.nextSibling,e.insertBefore(p,c),c=m=p,p=o,l++,f--,h<l||f<a)break e;i=t[l],s=n[f]}}if(f<a){if(l<=h){let t;for(;l<=h;)0===h?e.removeChild(g):(t=g.previousSibling,e.removeChild(g),g=t),h--}return}if(h<l){if(a<=f)for(;a<=f;)c?e.insertBefore(o(n[a],a,n),c):e.appendChild(o(n[a],a,n)),a++;return}const b=new Array(f+1-a),y=new Map;let w;for(w=a;w<=f;w++)b[w]=-1,y.set(n[w],w);let v=0,R=[];for(w=l;w<=h;w++)y.has(t[w])?(b[y.get(t[w])]=w,v++):R.push(w);if(0===v){for(e.textContent="",w=a;w<=f;w++)e.appendChild(o(n[w],w,n));return}const C=function(e,t){const n=[],o=[],r=new Array(e.length);let i,s,c,l=-1;for(i=t;i<e.length;i++){if(s=e[i],s<0)continue;let t,a=-1,u=n.length;if(u>0&&n[u-1]<=s)c=u-1;else{for(;u-a>1;)t=Math.floor((a+u)/2),n[t]>s?u=t:a=t;c=a}-1!==c&&(r[i]=o[c]),c===l?(l++,n[l]=s,o[l]=i):s<n[c+1]&&(n[c+1]=s,o[c+1]=i)}for(i=o[l];l>=0;i=r[i],l--)n[l]=i;return n}(b,a),x=[];let P=p;for(w=l;w<=h;w++)x[w]=P,P=P.nextSibling;for(w=0;w<R.length;w++)e.removeChild(x[R[w]]);let j,O=C.length-1;for(w=f;w>=a;w--)C[O]===w?(c=x[b[C[O]]],r(c,n[w]),O--):(-1===b[w]?j=o(n[w],w,n):(j=x[b[w]],r(j,n[w])),e.insertBefore(j,c),c=j)}(this,r,e,n,o)}const Y=e.location.origin+e.location.pathname,F=[Y,e.location.hostname,e.location.hostname+"/",e.location.origin];"/"!==Y[Y.length-1]&&F.push(Y+"/"),e.location.pathname&&"/"!==e.location.pathname&&F.push(e.location.pathname);const K=["/","#","/#","/#/",...F],X=new Set,Z=new Map,ee=new Map,te={},ne={params:{},keepQuery:!0,revertible:!0,forceReload:!1},oe={then:t=>t(e.location.href)};let re=0,ie=null,se=!1,ce=null,le=!1,ae={},ue=!1,he=!1,fe="",pe=null;const de={options:{recursionWarningCount:5,recursionThrowCount:10,defer:50},hook(e,t,n=null,o=!1){const r=we(e).hash;Z.has(r)||Z.set(r,[]);const i=Z.get(r);let s;s=!1===o?t.bind(n):e=>{t.call(n,e);const o=i.indexOf(s);i.splice(o,1)},i.push(s)},trigger(t,n={}){n=Object.assign({},ne,n);const{hash:o,query:r}=we(t),i=Z.get(o);if(i&&i.length){const t=!r&&n.keepQuery?e.location.search:r,o=Object.assign(Re(t),n.params);for(let e=0;e<i.length;e++)i[e](o)}},subscribe(t,n){if(!n)throw new Error('Router.subscribe requires second parameter to be "options" object or "onRoute" handler function.');if("function"==typeof n){n={onRoute:n}}else if("function"!=typeof n.beforeRoute&&"function"!=typeof n.onRoute)throw new Error('Router.subscribe requires "options" object with "beforeRoute", "onRoute" or both handler functions.');const o=we(t).hash,r="#"===o;if(X.has(o))throw new Error("root");X.add(o);const i=te[Y]=te[Y]||{beforeRoute:void 0,onRoute:void 0,children:{}};if(r)i.beforeRoute=n.beforeRoute,i.onRoute=n.onRoute;else{const e=o.split("/"),t=e[e.length-1];e.reduce((e,o)=>e[o]?(o===t&&(e[o].beforeRoute=n.beforeRoute,e[o].onRoute=n.onRoute),e[o].children):(e[o]={beforeRoute:o===t?n.beforeRoute:void 0,onRoute:o===t?n.onRoute:void 0,children:{}}).children,i.children)}!1!==n.autorun&&de.navigate(e.location.href,{revertible:!1,forceReload:!0}).then(t=>{e.history.replaceState(null,document.title,t)}),!1===he&&(he=!0,e.addEventListener("popstate",()=>{de.navigate(e.location.href,{revertible:!1,forceReload:!1}).then(t=>{e.history.replaceState(null,document.title,t)})}))},navigate:(e,t={})=>(t=Object.assign({},ne,t),de.options.defer>0?new Promise(n=>{clearTimeout(pe),pe=setTimeout(()=>{ge(e,t).then(e=>n(e)),pe=null},de.options.defer)}):ge(e,t))};function ge(t,n){const{abs:o,hash:r,query:i}=we(t),s=!i&&n.keepQuery?e.location.search:i;ae=Object.assign(Re(s),n.params);const c=Z.get(r);if(c)for(let e=0;e<c.length;e++)c[e](ae);return o===fe&&!1===n.forceReload?oe:ue?(console.warn('Router.navigate to "'+t+'" not executed because another navigation is still in progress.'),oe):(ue=!0,new Promise(t=>{var r;(r=o,new Promise(e=>{re=0,se=!1,ce=null,ie=e,le=!1,te[Y]||ie(null),me(r)})).then(o=>{(function e(t,n=""){return new Promise(o=>{null===t||"/"===t.value?o(n):Promise.resolve(t.nextNode).then(r=>{n+=0===n.length||t.value===Y||"#"===t.value[0]?t.value:"/"+t.value,o(e(r,n))})})})(o).then(r=>{const i=new URL(r);i.search=s;const c=i.toString();r===fe&&!1===n.forceReload?(ue=!1,t(c)):function e(t,n=[]){return new Promise(o=>{null===t.nextNode&&o(n),Promise.resolve(t.nextNode).then(r=>{null!==r&&(t.onRoute&&n.push([t.onRoute,r.value]),o(e(r,n)))})})}(o).then(o=>{for(let e,t,r,i=0;i<o.length;i++)e=o[i],t=e[0],r=e[1],!0!==n.forceReload&&ee.has(t)&&ee.get(t)===r||(t(r,ae),ee.set(t,r));fe=r,!0===n.revertible&&e.history.pushState(null,document.title,c),ue=!1,t(c)})})})}))}function me(e){if(e===Y)null!==ce?ie(ce):be(te,[Y]).then(e=>{ce=e,!1===le&&(le=!0,ie(ce))});else if(0===e.lastIndexOf(Y,0)){const t=e.substr(Y.length);if("#"!==t[0])throw new Error('Invalid route "'+t+'". Nested routes must be hash based.');null!==ce?be(te.children,t.split("/")).then(e=>{!1===le&&(le=!0,ie(Object.assign(ce,{nextNode:e})))}):be(te,[Y,...t.split("/")]).then(e=>{ce=e,!1===le&&(le=!0,ie(ce))})}else"#"===e[0]&&be(te[Y].children,e.split("/")).then(e=>{!1===le&&(le=!0,ie(Object.assign(ce,{nextNode:e})))})}function be(e,t,n=""){return new Promise(o=>{const r=t[0],i=e[r];if(!i||se)o({value:t.length&&n.length?n+"/"+t.join("/"):t.length?t.join("/"):n.length?n:"/",nextNode:null});else{n+=0===n.length?r:"/"+r;const s=t.slice(1);if(i.beforeRoute){const c=function e(t,n,o=""){const r=n[0],i=t[r];if(!i)return n.length&&o.length?o+"/"+n.join("/"):n.length?n.join("/"):o.length?o:"/";if(o+=0===o.length?r:"/"+r,i.beforeRoute||i.onRoute)return o;return e(i.children,n.slice(1),o)}(i.children,s);Promise.resolve(i.beforeRoute(c,ae)).then(l=>{if(l="string"==typeof l?function(e){const t=ve(e,F);return t?e.replace(t,Y):e}(function(e){e.length>1&&"/"===e[0]&&(e=e.substr(1));e.length>1&&"/"===e[e.length-1]&&(e=e.slice(0,-1));return e}(l)):c,c===l)o({value:n,onRoute:i.onRoute,nextNode:be(i.children,s)});else if(r===Y){if("/"!==c&&"#"!==c[0])throw new Error('Invalid Route Setup: "'+c+'" can not directly follow root url. Routes at this level must start with a #.');if("#"!==l[0])throw new Error('Invalid Route "'+l+'" returned from beforeRoute. Routes at this level must start with a #.');o({value:n,onRoute:i.onRoute,nextNode:be(i.children,l.split("/"))})}else"#"===r[0]?"/"===c?o({value:n,onRoute:i.onRoute,nextNode:be(i.children,l.split("/"))}):"/"===l||"#"===l[0]?ye(t)&&o(be(e,l.split("/"))):o({value:n,onRoute:i.onRoute,nextNode:be(i.children,l.split("/"))}):l===Y||"#"===l[0]||0===l.lastIndexOf(Y,0)?ye(t)&&me(l):o({value:n,onRoute:i.onRoute,nextNode:be(i.children,l.split("/"))})})}else i.onRoute?o({value:n,onRoute:i.onRoute,nextNode:be(i.children,s)}):o(be(i.children,s,n))}})}function ye(e){if(re++,re===de.options.recursionThrowCount)throw se=!0,new Error('Router.navigate is causing potentially infinite route rewrites at "'+e.join("/")+'". Stopped execution after '+de.options.recursionThrowCount+" cycles...");return re===de.options.recursionWarningCount&&console.warn("Router.navigate is causing more than "+de.options.recursionWarningCount+" route rewrites..."),!0}function we(e){if(K.indexOf(e)>-1)return{abs:Y,hash:"#",query:""};if("?"===e[0]||"#"===e[0]){const t=new URL(e,Y);return{abs:Y+t.hash,hash:t.hash||"#",query:t.search}}if("?"!==(e=function(e){const t=ve(e,K);return t?e.substr(t.length):e}(e))[0]&&"#"!==e[0])throw new Error('Invalid Route: "'+e+'". Non-root paths must start with ? query or # hash.');const t=new URL(e,Y);return{abs:Y+t.hash,hash:t.hash||"#",query:t.search}}function ve(e,t){return t.filter(t=>0===e.lastIndexOf(t,0)).sort((e,t)=>t.length-e.length)[0]}function Re(e){const t={};if(e.length>1){const n=e.substring(1).replace(/\+/g," ").replace(/;/g,"&").split("&");for(let e,o,r=0;r<n.length;r++)e=n[r].split("=",2),o=decodeURIComponent(e[0]),o&&(t[o]=!(e.length>1)||decodeURIComponent(e[1]))}return t}const Ce={Component:G,Store:O,Server:u,Router:de};"object"==typeof module&&"object"==typeof module.exports?module.exports=Ce:"function"==typeof define&&define.amd?define("Cue",[],(function(){return Ce})):e.Cue=Ce}(window||this);