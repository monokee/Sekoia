!function(t){const e=document.createElement("template");function s(t){if(!t||"object"!=typeof t)return t;if(Array.isArray(t)){const e=[];for(let i=0;i<t.length;i++)e.push(s(t[i]));return e}const e={};for(const i in t)t.hasOwnProperty(i)&&(e[i]=s(t[i]));return e}const i={patchData(t,e,s,i){return this.t=!1,this.i(t,e,s,i),this.t},setupComputedProperties(t,e){return this.o(this.h(t,e))},buildDependencyGraph(t,e){for(const s of t.values())for(let t,i=0;i<s.sourceProperties.length;i++)t=s.sourceProperties[i],e.has(t)?e.get(t).push(s):e.set(t,[s]);return e},t:!1,u:null,l:[],p:null,m:null,v:{get(t,e){const s=i.m;if(!t.hasOwnProperty(e))throw{type:"cue-internal",message:`Cannot resolve computed property "${s.ownPropertyName}" because dependency "${e}" doesn't exist.`};s.sourceProperties.includes(e)||s.sourceProperties.push(e)}},i(t,e,i,r){if(t===e)return;const n=typeof t,o=typeof e;if(t&&e&&"object"===n&&"object"===o){if(t.constructor!==e.constructor)return;if(Array.isArray(t)){if(Array.isArray(e)){const i=t.length;if(0===i){if(0===e.length)return;for(let i=0;i<e.length;i++)t.push(s(e[i]));return void(this.t=!0)}if(e.length<=i){t.length=e.length;for(let s=0;s<t.length;s++)this.i(t[s],e[s],t,s)}else{const r=i-1,n=t[r];for(let i=0;i<e.length;i++)i<=r?this.i(t[i],e[i],t,i):this._(n,e[i])&&t.push(s(e[i]))}return void(i!==t.length&&(this.t=!0))}return}for(const s in t)t.hasOwnProperty(s)&&this.i(t[s],e[s],t,s)}else o===n&&(i[r]=e,this.t=!0)},_(t,e){if(t===e)return!0;const s=typeof t,i=typeof e;if(t&&e&&"object"===s&&"object"===i){if(t.constructor!==e.constructor)return!1;if(Array.isArray(t)){if(Array.isArray(e)){const s=t.length;if(0===s)return!0;if(e.length<=s){for(let s=0;s<e.length;s++)if(!this._(t[s],e[s]))return!1}else{const i=s-1,r=t[i];for(let t=i;t<e.length;t++)if(!this._(r,e[t]))return!1}return!0}return!1}for(const s in t)if(t.hasOwnProperty(s)&&!this._(t[s],e[s]))return!1;return!0}return i===s},h(t,e){this.p=e;const s=new Proxy(t,this.v);for(const t of e.values()){this.m=t;try{t.computation(s)}catch(t){if(t.type&&"cue-internal"===t.type)throw new Error(t.message)}}return this.m=null,this.p=null,e},o(t){this.u=t;const e=new Map;for(const s of t.keys())this.g(s,[],e);for(this.u=null;this.l.length;)this.l.pop();return e},g(t,e,s){if(this.u.has(t)){e.push(t),this.l.push(t);const i=this.u.get(t);for(let t,r=0;r<i.sourceProperties.length;r++){if(t=i.sourceProperties[r],e.includes(t))throw new Error(`Circular dependency. "${i.ownPropertyName}" is required by "${t}": ${e.join(" -> ")}`);this.l.includes(t)||this.g(t,e,s)}s.has(t)||s.set(t,i)}}};function r(t,e){if(t===e)return!0;if(t&&e&&"object"==typeof t&&"object"==typeof e){if(t.constructor!==e.constructor)return!1;if(Array.isArray(t)){if(t.length!==e.length)return!1;for(let s=t.length;0!=s--;)if(!r(t[s],e[s]))return!1;return!0}const s=Object.keys(t),i=s.length;if(i!==Object.keys(e).length)return!1;for(let t=i;0!=t--;)if(!Object.prototype.hasOwnProperty.call(e,s[t]))return!1;for(let n,o=i;0!=o--;)if(n=s[o],!r(t[n],e[n]))return!1;return!0}return t!=t&&e!=e}class n{constructor(t,e,s,i,r){this.ownPropertyName=t,this.isPrivate=e,this.computation=s,this.sourceProperties=i,this.sourceProxy=r,this.intermediate=void 0,this.value=void 0,this.needsUpdate=!0,this.hasChanged=!1}clone(t){return new this.constructor(this.ownPropertyName,this.isPrivate,this.computation,this.sourceProperties,t)}getValue(){return this.needsUpdate&&(this.intermediate=this.computation(this.sourceProxy,this.value),r(this.intermediate,this.value)?this.hasChanged=!1:(this.value=this.intermediate,this.hasChanged=!0),this.needsUpdate=!1),this.value}}n.prototype._isComputedProperty_=!0;class o{constructor(t){let e;this.instances=0,this.nativeData={},this.privateKeys=new Set,this.boundProperties=new Map,this.computedProperties=new Map;for(const s in t)if(t.hasOwnProperty(s)){0===s.indexOf("_")?(this.privateKeys.add(s),e=!0):e=!1;const i=t[s];if(i?._isBinding_){if(e&&!i.readonly)throw new Error(`Can not bind("${i.ownPropertyName}") to private key "${s}" because it is only accessible by this object.`);this.boundProperties.set(s,i)}else"function"==typeof i?this.computedProperties.set(s,new n(s,e,i,[],null)):this.nativeData[s]=i}this.computedProperties.size&&(this.computedProperties=i.setupComputedProperties(t,this.computedProperties))}}const h={setState(t){return this.j.set(++this.S,t),this.S},popState(t){if(t=Number(t),this.j.has(t)){const e=this.j.get(t);return this.j.delete(t),e}},j:new Map,S:-1},c=/(\$self(?=[\\040,{.:#[>+~]))|\$self\b/g,u=[" ",".",":","#","[",">","+","~"];let f=-1;const a=document.head.appendChild(document.createElement("style")),l=document.head.appendChild(document.createElement("style")),d=new Set;class p{static createTag(t,e){let s="<"+t;if(e)for(const t in e)if(e.hasOwnProperty(t)){const i=e[t];"string"==typeof i?s+=" "+t+'="'+i+'"':"state"===t&&(i&&i._internal_?s+=' provided-state="'+h.setState(i)+'"':s+=' composed-state-data="'+h.setState(i)+'"')}return s+"></"+t+">"}static createNode(t,e,s){const i=document.createElement(t);if(e)if(e._internal_)i.state=e;else for(const t in e)if(e.hasOwnProperty(t)){const r=e[t];"state"===t?r&&r._internal_?i.state=r:i.state=s(r):i.setAttribute(t,e[t])}return i}constructor(t,e){d.add(t.toUpperCase()),this.R=t,e.style||e.element?(this.D=e.style,this.k=e.element||"",this.C=!1):this.C=!0,e.state&&(this.M=e.state),this.initialize=e.initialize}setupStateOnce(){if(this.state)return!0;if(this.M){const t={},e=new Map,s=new Map;for(const i in this.M)if(this.M.hasOwnProperty(i)){const r=this.M[i];t[i]=r.value,"function"==typeof r.render?e.set(i,r.render):"object"==typeof r.renderList&&s.set(i,r.renderList)}return this.state=new o(t),this.renderEvents=e,this.renderListConfigs=s,this.M=null,!0}return!1}compileTemplateOnce(){if(!this.C){const t=document.createElement("template");if(t.innerHTML=this.k||"",this.content=t.content,this.refs=new Map,this.P(this.content.children),this.D){let t=this.D;t=t.replace(c,this.R);for(const[e,s]of this.refs)t=t.replace(new RegExp("(\\"+e+"(?=[\\40{,.:#[>+~]))|\\"+e+"\b","g"),"."+s);a.innerHTML=t;const e=a.sheet;let s="",i="";for(let t,r=0;r<e.rules.length;r++)t=e.rules[r],7===t.type||8===t.type?s+=t.cssText:1===t.type?s+=this.$(t):4===t.type||12===t.type?i+=this.O(t):console.warn(`CSS Rule of type "${t.type}" is not supported.`);l.innerHTML+=s+i,a.innerHTML=this.D=""}this.C=!0}}P(t){for(let e,s,i,r,n=0;n<t.length;n++)e=t[n],s=e.getAttribute("$"),s&&(i=e.getAttribute("class"),r=s+ ++f,this.refs.set("$"+s,r),e.setAttribute("class",i?i+" "+r:r),e.removeAttribute("$")),e.firstElementChild&&!d.has(e.tagName)&&this.P(e.children)}O(t,e=""){4===t.type?e+="@media "+t.media.mediaText+" {":e+="@supports "+t.conditionText+" {";let s="";for(let i,r=0;r<t.cssRules.length;r++)i=t.cssRules[r],7===i.type||8===i.type?e+=i.cssText:1===i.type?e+=this.$(i,e):4===i.type||12===i.type?s+=this.O(i):console.warn(`CSS Rule of type "${i.type}" is not currently supported by Components.`);return e+=s+" }"}$(t){let e="";if(t.selectorText.indexOf(",")>-1){const s=t.selectorText.split(","),i=[];for(let t,e=0;e<s.length;e++)t=s[e].trim(),0===t.lastIndexOf(":root",0)?i.push(t.replace(":root","")):this.q(t,this.R)?i.push(t):i.push(this.R+" "+t);e+=i.join(", ")+t.cssText.substr(t.selectorText.length)}else 0===t.selectorText.lastIndexOf(":root",0)?e+=t.cssText.replace(":root",""):this.q(t.selectorText)?e+=t.cssText:e+=this.R+" "+t.cssText;return e}q(t){return t===this.R||0===t.lastIndexOf(this.R,0)&&u.indexOf(t.charAt(this.R.length))>-1}}const y=t.requestAnimationFrame,w={tick:0,keyEvents:new Map,wildcardEvents:new Map,computedProperties:new Set,dependencies:new Set,resolvedComputedProperties:new Set,flush(){this.A||(this.A=y(this.T))},throttle(t,e){let s=-9999999;return i=>{const r=this.tick;if(r-s>e)return s=r,t(i)}},A:0,I:new Map,U:new Map,T(t){this.tick=t;const e=this.keyEvents;if(e.size){this.keyEvents=this.I,this.I=e;for(const[t,s]of e)t(s),e.delete(t)}const s=this.wildcardEvents;if(s.size){this.wildcardEvents=this.U,this.U=s;for(const[t,e]of s)t(e),s.delete(t)}this.keyEvents.size||this.wildcardEvents.size?this.T(t):this.A=0}};function b(t,e){const s=Array.isArray(t)?t.slice(0):Object.values(t||{}),i=e.parentElement,r=i._renderListData_||[];if(i._renderListData_=s,0===s.length)i.innerHTML="";else if(0===r.length)for(let t=0;t<s.length;t++)i.appendChild(e.createChild(s[t],t,s));else!function(t,e,s,i,r){let n,o,h=0,c=0,u=!0,f=e.length-1,a=s.length-1,l=t.firstChild,d=l,p=t.lastChild,y=p,w=null;t:for(;u;){let i;for(u=!1,n=e[h],o=s[c];n===o;){if(r&&r(l,o),h++,c++,d=l=l.nextSibling,f<h||a<c)break t;n=e[h],o=s[c]}for(n=e[f],o=s[a];n===o;){if(r&&r(p,o),f--,a--,w=p,y=p=p.previousSibling,f<h||a<c)break t;n=e[f],o=s[a]}for(n=e[f],o=s[c];n===o;){if(u=!0,r&&r(p,o),i=p.previousSibling,t.insertBefore(p,d),y=p=i,c++,f--,f<h||a<c)break t;n=e[f],o=s[c]}for(n=e[h],o=s[a];n===o;){if(u=!0,r&&r(l,o),i=l.nextSibling,t.insertBefore(l,w),w=y=l,l=i,h++,a--,f<h||a<c)break t;n=e[h],o=s[a]}}if(a<c){if(h<=f){let e;for(;h<=f;)0===f?t.removeChild(p):(e=p.previousSibling,t.removeChild(p),p=e),f--}return}if(f<h){if(c<=a)for(;c<=a;)w?t.insertBefore(i(s[c],c,s),w):t.appendChild(i(s[c],c,s)),c++;return}const b=new Array(a+1-c),m=new Map;let v;for(v=c;v<=a;v++)b[v]=-1,m.set(s[v],v);let _=0,g=[];for(v=h;v<=f;v++)m.has(e[v])?(b[m.get(e[v])]=v,_++):g.push(v);if(0===_){for(t.textContent="",v=c;v<=a;v++)t.appendChild(i(s[v],v,s));return}const j=function(t,e){const s=[],i=[],r=new Array(t.length);let n,o,h,c=-1;for(n=e;n<t.length;n++){if(o=t[n],o<0)continue;let e,u=-1,f=s.length;if(f>0&&s[f-1]<=o)h=f-1;else{for(;f-u>1;)e=Math.floor((u+f)/2),s[e]>o?f=e:u=e;h=u}-1!==h&&(r[n]=i[h]),h===c?(c++,s[c]=o,i[c]=n):o<s[h+1]&&(s[h+1]=o,i[h+1]=n)}for(n=i[c];c>=0;n=r[n],c--)s[c]=n;return s}(b,c),S=[];let R=l;for(v=h;v<=f;v++)S[v]=R,R=R.nextSibling;for(v=0;v<g.length;v++)t.removeChild(S[g[v]]);let E,D=j.length-1;for(v=a;v>=c;v--)j[D]===v?(w=S[b[j[D]]],r&&r(w,s[v]),D--):(-1===b[v]?E=i(s[v],v,s):(E=S[b[v]],r&&r(E,s[v])),t.insertBefore(E,w),w=E)}(i,r,s,e.createChild,e.updateChild)}w.T=w.T.bind(w);class m{constructor(t,e,s){this.sourceInternals=t,this.ownPropertyName=e,this.readonly=s,this.connectedObjectInternals=new Map}connect(t,e){if(t===this.sourceInternals)throw new Error(`Failed to bind "${e}". Cannot bind object to itself.`);if(this.connectedObjectInternals.has(t))throw new Error(`Failed to bind "${e}". Cannot bind to an object more than once.`);this.connectedObjectInternals.set(t,e)}observeSource(t,e,s){return this.sourceInternals.observe(this.ownPropertyName,t,e,s)}getValue(t){return this.sourceInternals.getDatum(this.ownPropertyName,t)}getDefaultValue(){return this.sourceInternals.getDefaultDatum(this.ownPropertyName)}setValue(t,e){this.sourceInternals.setDatum(this.ownPropertyName,t,e)}}m.prototype._isBinding_=!0;class v{constructor(t){const e=++t.instances>1;this.model=t,this.privateKeys=t.privateKeys,this.boundProperties=t.boundProperties,this.modelNativeData=t.nativeData,this.nativeData={},this.allProperties={},this.settableProperties={},this.bindings=new Map,this.events=new Map,this.computedProperties=new Map,this.dependencyGraph=new Map,this.parentInternals=null,this.ownPropertyName="";for(const t in this.modelNativeData)if(this.modelNativeData.hasOwnProperty(t)){const i=this.modelNativeData[t];i&&i._internal_?(this.nativeData[t]=e?i._internal_.owner.clone():i,this.nativeData[t]._internal_.parentInternals=this,this.nativeData[t]._internal_.ownPropertyName=t):this.nativeData[t]=s(i)}for(const[e,s]of t.boundProperties)s.connect(this,e);if(t.computedProperties.size){const e=new Proxy(this.allProperties,{get:(t,e)=>this.getDatum(e,!1)});for(const[s,i]of t.computedProperties)this.computedProperties.set(s,i.clone(e));i.buildDependencyGraph(this.computedProperties,this.dependencyGraph)}}getDefaultDatum(t){if(this.modelNativeData.hasOwnProperty(t)){const e=this.modelNativeData[t];return e?._internal_?e._internal_.getDefaultData():e}if(this.boundProperties.has(t))return this.boundProperties.get(t).getDefaultValue()}getDefaultData(){let t,e;for([t,e]of this.boundProperties)e.readonly||(this.settableProperties[t]=e.getDefaultValue());for(t in this.modelNativeData)this.modelNativeData.hasOwnProperty(t)&&(e=this.modelNativeData[t],this.settableProperties[t]=e?._internal_?e._internal_.getDefaultData():e);return this.settableProperties}getDatum(t,e){if(this.nativeData.hasOwnProperty(t)){const s=this.nativeData[t];if(!e)return s;if(s?._internal_)return s._internal_.getData(e);if(!this.privateKeys.has(t))return s}else{if(this.boundProperties.has(t))return this.boundProperties.get(t).getValue(e);if(!e&&this.computedProperties.has(t))return this.computedProperties.get(t).getValue()}}getData(t){const e={};let s,i;for(s in this.nativeData)this.nativeData.hasOwnProperty(s)&&(i=this.nativeData[s],t?i?._internal_?e[s]=i._internal_.getData(t):this.privateKeys.has(s)||(e[s]=i):e[s]=i);for([s,i]of this.boundProperties)t&&!i.readonly&&(e[s]=i.getValue(t));if(!t)for(const[t,s]of this.computedProperties)e[t]=s.getValue();return e}setDatum(t,e,s){this.nativeData.hasOwnProperty(t)?this.nativeData[t]?._internal_?this.nativeData[t]._internal_.setData(e,s):i.patchData(this.nativeData[t],e,this.nativeData,t)&&!s&&this.resolve(t,e):this.boundProperties.has(t)&&this.boundProperties.get(t).setValue(e,s)}setData(t,e){for(const s in t)t.hasOwnProperty(s)&&this.setDatum(s,t[s],e)}observe(t,e,s,i){if(this.boundProperties.has(t))return this.boundProperties.get(t).observeSource(e,s,i);if(this.nativeData[t]?._internal_)return this.nativeData[t]._internal_.observe("*",e,s,i);{const r=this.events.get(t);if(r?r.push(e):this.events.set(t,[e]),!i){if("*"===t)w.wildcardEvents.set(e,this.owner);else{const s=this.computedProperties.get(t);s?w.keyEvents.set(e,s.getValue()):w.keyEvents.set(e,this.nativeData[t])}w.flush()}if(s)return()=>{const s=this.events.get(t);s&&s.includes(e)&&s.splice(s.indexOf(e),1)}}}bind(t){if(this.boundProperties.has(t))throw new Error(`Cannot bind("${t}") because that property is already bound itself. Instead of chaining, bind directly to the source.`);if(this.privateKeys.has(t))throw new Error(`Cannot bind("${t}") because it is private and only available to the source object internally.`);if(!this.bindings.has(t)){const e=this.computedProperties.has(t);this.bindings.set(t,new m(this,t,e))}return this.bindings.get(t)}resolve(t,e){let s=this.privateKeys.has(t);const i=this.dependencyGraph,r=this.events,n=w.keyEvents,o=i.get(t);if(o){const t=w.computedProperties,e=w.resolvedComputedProperties,h=w.dependencies;for(let e=0;e<o.length;e++)t.add(o[e]);for(;t.size;){for(const i of t){if(!e.has(i)){i.needsUpdate=!0;const t=i.getValue();if(!0===i.hasChanged){const e=r.get(i.ownPropertyName);if(e)for(let s=0;s<e.length;s++)n.set(e[s],t);i.isPrivate||(s=!1),h.add(i)}e.add(i)}t.delete(i)}for(const e of h){const s=i.get(e.ownPropertyName);if(s)for(let e=0;e<s.length;e++)t.add(s[e]);h.delete(e)}}e.clear()}const h=r.get(t);if(h)for(let t=0;t<h.length;t++)n.set(h[t],e);if(!s){const s=r.get("*");if(s){const t=w.wildcardEvents;for(let e=0;e<s.length;e++)t.set(s[e],this.owner)}const i=this.bindings.get(t);if(i)for(const[t,s]of i.connectedObjectInternals)t.resolve(s,e);this.parentInternals&&this.parentInternals.resolve(this.ownPropertyName,this.owner)}w.flush()}}class _{constructor(t){Object.defineProperty(this,"_internal_",{value:t})}get(t){return void 0===t?this._internal_.getData(!1):this._internal_.getDatum(t,!1)}default(t){return s(void 0===t?this._internal_.getDefaultData():this._internal_.getDefaultDatum(t))}snapshot(t){if(void 0===t){const t=this._internal_.getData(!0);if(Array.isArray(t))for(let e=0;e<t.length;e++)t[e]=s(t[e]);else for(const e in t)t.hasOwnProperty(e)&&(t[e]=s(t[e]));return t}return s(this._internal_.getDatum(t,!0))}set(t,e){"object"==typeof t?this._internal_.setData(t):this._internal_.setDatum(t,e)}reset(t){void 0===t?this.set(this.default()):this.set(t,this.default(t))}}class g{constructor(t,e=100){this.L=[],this.N=0,this.F=!1,this.V=e,this.G=t}prev(){return this.N-1}next(){return this.N+1}has(t){return!(t<0||!this.L.length)&&t<=this.L.length-1}get(t){return t!==this.N&&(this.F=!0,this.N=t,this.G&&this.G(this.L[t],t,this.L.length)),this.L[t]}add(t,e){if(!this.F)return t=t?._internal_?t.snapshot():t,(!e||!r(t,this.L[this.N]))&&(this.N+1<this.L.length&&this.L.splice(this.N+1,this.L.length-this.N-1),this.L.length===this.V&&this.L.shift(),this.L.push(t),this.N=this.L.length-1,this.G&&this.G(this.L[this.N],this.N,this.L.length),!0);this.F=!1}}function j(t,e=100){let s=0;return i=>{clearTimeout(s),s=setTimeout(t,e,i)}}class S extends _{static _from_(t,e){const s=Object.create(S.prototype);return s._internal_=new v(t),s._internal_.owner=s,e&&s._internal_.setData(e,!0),s}constructor(t){const e=new o(t),s=new v(e);super(s),s.owner=this}clone(t){return this.constructor._from_(this._internal_.model,t)}observe(t,e,s={}){if("object"!=typeof t)return(s.throttle||0)>0?this._internal_.observe(t,w.throttle(e,s.throttle),s.cancelable,s.silent):(s.defer||0)>0?this._internal_.observe(t,j(e,s.defer),s.cancelable,s.silent):this._internal_.observe(t,e,s.cancelable,s.silent);for(const e in t)t.hasOwnProperty(e)&&this._internal_.observe(e,t[e],!1,!1)}bind(t){return this._internal_.bind(t)}track(t,e={}){t||(t="*");const s=this._internal_.stateTrackers||(this._internal_.stateTrackers=new Map);if(s.has(t))throw new Error(`Cannot track state of "${t}" because the property is already being tracked.`);if(this._internal_.computedProperties.has(t))throw new Error(`Cannot track computed property "${t}". Only track writable properties.`);const i=new g(e.onTrack,e.maxEntries);s.set(t,i);const r=(e.throttle||0)>0||(e.defer||0)>0;return this.observe(t,(t=>i.add(t,r)),e)}undo(t){t||(t="*"),this.restore(t,this._internal_.stateTrackers?.get(t)?.prev())}redo(t){t||(t="*"),this.restore(t,this._internal_.stateTrackers?.get(t)?.next())}restore(t,e){void 0===e&&"number"==typeof t&&(e=t,t="*");const s=this._internal_.stateTrackers?.get(t);s&&s.has(e)&&("*"===t?this._internal_.setData(s.get(e),!1):this._internal_.setDatum(t,s.get(e),!1))}}class R extends HTMLElement{constructor(t){super(),Object.defineProperties(this,{_initialized_:{value:!1,writable:!0},_model_:{value:t}})}connectedCallback(){if(!1===this._initialized_){this._initialized_=!0;const t=this._model_,e=new Proxy({$self:this},{get:(e,s)=>e[s]||(e[s]=this.getElementsByClassName(t.refs.get(s))[0])});if(t.compileTemplateOnce(),this.appendChild(t.content.cloneNode(!0)),t.setupStateOnce()){this.hasAttribute("provided-state")?(this.state=h.popState(this.getAttribute("provided-state")),this.removeAttribute("provided-state")):(this.state=this.state||S._from_(t.state),this.hasAttribute("composed-state-data")&&(this.state._internal_.setData(h.popState(this.getAttribute("composed-state-data")),!1),this.removeAttribute("composed-state-data")));for(const[s,i]of t.renderEvents)this.state._internal_.observe(s,(t=>i(e,t)));for(const[s,i]of t.renderListConfigs){const t={parentElement:e[i.parentElement],createChild:i.createChild,updateChild:i.updateChild};this.state._internal_.getDatum(s)._internal_.setStructuralObserver((e=>{b(e._internal_.nativeData,t)}))}}t.initialize&&w.wildcardEvents.set(t.initialize.bind(this),e)}}}const E=t.location.origin+t.location.pathname,D=[E,t.location.hostname,t.location.hostname+"/",t.location.origin];"/"!==E[E.length-1]&&D.push(E+"/"),t.location.pathname&&"/"!==t.location.pathname&&D.push(t.location.pathname);const k=["/","#","/#","/#/",...D],C=new URL(E),M=H(E),P=new Map,$=new Set,O=[];let q=null;const A={},x={params:{},keepQuery:!0,forceReload:!1,history:"pushState"};let T=!1,I=J(t.location.search),U=["/"];t.location.hash&&U.push(...t.location.hash.split("/"));const L={before(t,e){if(N(),"*"===t)null!==q&&console.warn("Router.before(*, filter) - overwriting previously registered wildcard filter (*)"),q=e;else{const{hash:s}=G(t);if(P.has(s))throw new Error(`Router.beforeRoute() already has a filter for ${"#"===s?`${t} (root url)`:t}`);P.set(s,e)}},on(t,e){if(N(),"*"===t)-1===O.indexOf(e)&&O.push(e);else{const{hash:s}=G(t);if($.has(s))throw new Error('Router.onRoute() already has a action for "'+s=="#"?t+" (root url)":t+'".');$.add(s),function(t,e){const s=A["/"]||(A["/"]={action:void 0,children:{}});if("#"===t)s.action=e;else{const i=t.split("/"),r=i[i.length-1];i.reduce(((t,s)=>t[s]?(s===r&&(t[s].action=e),t[s].children):(t[s]={action:s===r?e:void 0,children:{}}).children),s.children)}}(s,e)}},hasFilter(t){if("*"===t)return null!==q;{const{hash:e}=G(t);return P.has(e)}},hasAction(t){if("*"===t)return O.length>0;{const{hash:e}=G(t);return $.has(e)}},navigate(e,s={}){if(0===e.lastIndexOf("http",0)&&e!==t.location.href)return t.location.href=e;const{hash:i,query:r,rel:n}=G(e);!0===(s=Object.assign({},x,s)).keepQuery?Object.assign(I,J(r)):I=J(r),q?q(n,I,(t=>{t!==n?V(t):P.has(i)?P.get(i)(n,I,(t=>{t!==n?V(t):Q(i,r,s.keepQuery,s.history)})):Q(i,r,s.keepQuery,s.history)})):P.has(i)?P.get(i)(n,I,(t=>{t!==n?V(t):Q(i,r,s.keepQuery,s.history)})):Q(i,r,s.keepQuery,s.history)},resolve(e={}){this.navigate(t.location.href,e)},getQueryParameters:t=>t?I[t]:Object.assign({},I),addQueryParameters(t,e){if(void 0===e&&"object"==typeof t)for(const e in t)I[e]=t[e];else I[t]=e;F()},setQueryParameters(t){I=s(t),F()},removeQueryParameters(t){t?Array.isArray(t)?t.forEach((t=>{I[t]&&delete I[t]})):I[t]&&delete I[t]:I={},F()}};function N(){T||(T=!0,t.addEventListener("popstate",(()=>{L.navigate(t.location.href,{history:"replaceState",forceReload:!1})})))}function Q(e,s,i,r){!function(t){const e=M+(t="#"===t?"":t);for(let t=0;t<O.length;t++)O[t](e,I)}(e),function(t){const e=["/"];"#"!==t&&e.push(...t.split("/"));const s=function(t,e){const s=[];for(let i=0;i<t.length;i++)for(let r=0;r<e.length;r++)if(t[i]===e[r]){s.push(t[i]);break}return s}(U,e),i=[s[s.length-1]];e.length>s.length&&i.push(...function(t,e){const s=[];for(let i=t.length;i<e.length;i++)s.push(e[i]);return s}(s,e));let r,n=A;for(let t=0;t<s.length;t++){if(r=s[t],r===i[0]){r=i.shift();break}n=n[r].children}for(;n[r]&&i.length;)n[r].action&&n[r].action(i.join("/"),I),n=n[r].children,r=i.shift();n[r]&&n[r].action&&n[r].action("/",I);U=e}(e),C.hash=e,C.search=i?K(I):s,t.history[r](null,document.title,C.toString())}function F(){C.search=K(I),t.history.replaceState(null,document.title,C.toString())}function V(e){return 0===e.lastIndexOf("http",0)?t.location.href=e:L.navigate(e,{history:"replaceState",forceReload:!1})}function G(t){if(k.indexOf(t)>-1)return{rel:"/",abs:E,hash:"#",query:""};if("?"===t[0]||"#"===t[0]){const{hash:e,query:s}=z(t);return{rel:B(e),abs:E+e,hash:e||"#",query:s}}if("?"!==(t=function(t){const e=(i=t,r=k,r.filter((t=>0===i.lastIndexOf(t,0))).sort(((t,e)=>e.length-t.length))[0]),s=e?t.substr(e.length):t;var i,r;return 0===s.lastIndexOf("/",0)?s.substr(1):s}(t))[0]&&"#"!==t[0])throw new Error('Invalid Route: "'+t+'". Non-root paths must start with ? query or # hash.');const{hash:e,query:s}=z(t);return{rel:B(e),abs:E+e,hash:e||"#",query:s}}function z(t){const e=t.indexOf("#"),s=t.indexOf("?");if(-1===e)return{hash:"",query:H(new URL(t,E).search)};if(-1===s)return{hash:H(new URL(t,E).hash),query:""};const i=new URL(t,E);if(s<e)return{hash:H(i.hash),query:H(i.search)};let r=i.hash;const n=r.slice(r.indexOf("?"));return r=r.replace(n,""),{hash:H(r),query:H(n)}}function B(t){return("#"===t?"/":t)||"/"}function H(t){return"/"===t[t.length-1]?t.substring(0,t.length-1):t}function J(t){const e={};if(t.length>1){const s=t.substring(1).replace(/\+/g," ").replace(/;/g,"&").split("&");for(let t,i,r=0;r<s.length;r++)t=s[r].split("=",2),i=decodeURIComponent(t[0]),i&&(e[i]=!(t.length>1)||decodeURIComponent(t[1]))}return e}function K(t){let e="?";for(const s in t)t.hasOwnProperty(s)&&(e+=encodeURIComponent(s)+"="+encodeURIComponent(t[s])+"&");return"?"===e?e="":"&"===e[e.length-1]&&(e=e.substring(0,e.length-1)),e}const W=new Map,X=new Set,Y=new Set;function Z(t,e,s,i={}){if(W.has(t))return W.get(t);{const r={"Content-Type":"application/json"};return s&&(r.Authorization=`Bearer ${s}`),tt(X,t),W.set(t,fetch(t,{method:e,mode:"cors",cache:"no-store",credentials:"same-origin",headers:r,redirect:"follow",referrer:"no-referrer",body:"GET"===e?null:"string"==typeof i?i:JSON.stringify(i)}).then((t=>t.ok&&204===t.status?{}:t.text().then((t=>{try{return JSON.parse(t)}catch(e){return t}})))).finally((()=>{W.delete(t),tt(Y,t)}))).get(t)}}function tt(t,e){for(const s of t)("*"===s.includes||e.includes(s.includes))&&s.handler()}function et(t){if(!t.length)return"0";let e=0;for(let s,i=0;i<t.length;i++)s=t.charCodeAt(i),e=(e<<5)-e+s,e&=e;return e+""}class st{constructor(t){requestAnimationFrame((()=>{this.onsuccess({target:{result:t}})}))}onsuccess(){}}class it{constructor(){this.B=new Map}get(t){return new st(this.B.get(t))}getAll(){return new st(this.B)}put(t,e){return new st(this.B.set(e,t))}delete(t){return new st(this.B.delete(t))}clear(){return new st(this.B.clear())}}class rt{constructor(){const t=new it;this.H={objectStore:()=>t}}transaction(){return this.H}}const nt="store",ot=[nt];class ht{constructor(e={}){e=Object.assign({},{name:location.origin,onUnavailable:null},e),this.R=e.name,this.J=new Promise((s=>{try{let e,i=t.indexedDB.open(this.R);i.onupgradeneeded=t=>{e=t.target.result,e.createObjectStore(nt)},i.onsuccess=t=>{e=t.target.result,s(e)},i.onerror=t=>{e=new rt,s(e)}}catch(t){console.warn("[PersistentStorage]: indexedDB not available. Falling back to memory.",t),"function"==typeof e.onUnavailable&&e.onUnavailable(t),s(new rt)}}))}has(t){return this.J.then((e=>new Promise(((s,i)=>{const r=e.transaction(ot,"readonly").objectStore(nt).count(t);r.onsuccess=t=>s(!!t.target.result),r.onerror=i}))))}get(t){return this.J.then((e=>new Promise(((s,i)=>{const r=e.transaction(ot,"readonly").objectStore(nt),n=void 0===t?r.getAll():r.get(t);n.onsuccess=t=>s(t.target.result),n.onerror=i}))))}set(t,e){return this.J.then((s=>new Promise(((i,r)=>{const n=s.transaction(ot,"readwrite"),o=n.objectStore(nt);if("object"==typeof t)for(const e in t)t.hasOwnProperty(e)&&o.put(t[e],e);else o.put(e,t);n.onsuccess=i,n.onerror=r}))))}delete(t){return void 0===t?this.clear():this.J.then((e=>new Promise(((s,i)=>{const r=e.transaction(ot,"readwrite"),n=r.objectStore(nt);Array.isArray(t)?t.forEach((t=>n.delete(t))):n.delete(t),r.onsuccess=s,r.onerror=i}))))}clear(){return this.J.then((t=>new Promise(((e,s)=>{const i=t.transaction(ot,"readwrite").objectStore(nt).clear();i.onsuccess=e,i.onerror=s}))))}destroy(){return this.J.then((e=>new Promise(((s,i)=>{e.close();const r=t.indexedDB.deleteDatabase(this.R);r.onsuccess=s,r.onerror=i}))))}}let ct=null;function ut(t,e,s,i){const r={handler:i?()=>{t(),s.delete(r)}:t,includes:e};s.add(r)}const ft=t=>t;class at{constructor(t,e){t||(t=[]),this.nativeData=t,this.model=e?._model_?e._model_:"function"==typeof e?.model?t=>{const s=e.model(t);return s&&s._internal_&&(s._internal_.parentInternals=this),s}:ft,this.defaultData=[];for(let e,i=0;i<t.length;i++)e=t[i],e._internal_?(e._internal_.parentInternals=this,this.defaultData.push(s(e._internal_.getDefaultData()))):this.defaultData.push(s(e));this.wildcardEvents=[],this.events=new Map([["*",this.wildcardEvents]]),this.structuralObserver=ft,this.parentInternals=null,this.ownPropertyName=""}getDatum(t,e){const s=this.nativeData[t];return e&&s?._internal_?s._internal_.getData(e):s}getData(t){const e=[];for(let s,i=0;i<this.nativeData.length;i++)s=this.nativeData[i],t&&s?._internal_?e.push(s._internal_.getData(t)):e.push(s);return e}getDefaultDatum(t){return this.defaultData[t]}getDefaultData(){return this.defaultData}setData(t,e){let s=t.length!==this.nativeData.length;this.nativeData.length=t.length;for(let i,r,n=0;n<t.length;n++)i=t[n],r=this.nativeData[n],r!==i&&(r?._internal_&&i&&"object"==typeof i&&!i._internal_?r._internal_.setData(i,e):(!i||i._internal_||"object"!=typeof i?this.nativeData[n]=i:this.nativeData[n]=this.model(i),s=!0));s&&!e&&this.didMutate()}setDatum(t,e,s){const i=this.nativeData[t];i!==e&&(i?._internal_&&e&&"object"==typeof e&&!e._internal_?i._internal_.setData(e,s):(!e||e._internal_||"object"!=typeof e?this.nativeData[t]=e:this.nativeData[t]=this.model(e),s||this.didMutate()))}observe(t,e,s,i){if(this.events.get(t).push(e),i||(w.wildcardEvents.set(e,this.owner),w.flush()),s)return()=>this.wildcardEvents.splice(this.wildcardEvents.indexOf(e),1)}setStructuralObserver(t){this.K?this.K=t:(this.K=t,this.wildcardEvents.unshift((t=>{this.structuralObserver(t),this.structuralObserver=ft})))}didMutate(){this.structuralObserver=this.K;for(let t=0;t<this.wildcardEvents.length;t++)w.wildcardEvents.set(this.wildcardEvents[t],this.owner);this.parentInternals&&this.parentInternals.resolve(this.ownPropertyName,this.owner),w.flush()}resolve(){for(let t=0;t<this.wildcardEvents.length;t++)w.wildcardEvents.set(this.wildcardEvents[t],this.owner);this.parentInternals&&this.parentInternals.resolve(this.ownPropertyName,this.owner)}}class lt extends _{constructor(t,e){super(new at(t,e)),this._internal_.owner=this}clone(){return new this.constructor(this._internal_.defaultData,{_model_:this._internal_.model})}get length(){return this._internal_.nativeData.length}every(t){return this._internal_.nativeData.every(t)}some(t){return this._internal_.nativeData.some(t)}findIndex(t){return this._internal_.nativeData.findIndex(t)}findLastIndex(t){const e=this._internal_.nativeData;let s=e.length;for(;s--;)if(t(e[s],s,e))return s;return-1}includes(t){return this._internal_.nativeData.includes(t)}indexOf(t,e){return this._internal_.nativeData.indexOf(t,e)}lastIndexOf(t,e){return this._internal_.nativeData.lastIndexOf(t,e)}find(t){return this._internal_.nativeData.find(t)}slice(t){return this._internal_.nativeData.slice(t)}forEach(t){return this._internal_.nativeData.forEach(t)}filter(t){return this._internal_.nativeData.filter(t)}map(t){return this._internal_.nativeData.map(t)}reduce(t,e){return this._internal_.nativeData.reduce(t,e)}pop(){if(this._internal_.nativeData.length){const t=this._internal_.nativeData.pop();return this._internal_.didMutate(),t}}push(t){!t||t._internal_||"object"!=typeof t?this._internal_.nativeData.push(t):this._internal_.nativeData.push(this._internal_.model(t)),this._internal_.didMutate()}shift(){if(this._internal_.nativeData.length){const t=this._internal_.nativeData.shift();return this._internal_.didMutate(),t}}unshift(t){!t||t._internal_||"object"!=typeof t?this._internal_.nativeData.unshift(t):this._internal_.nativeData.unshift(this._internal_.model(t)),this._internal_.didMutate()}splice(t,e,...s){if(e||s.length){if(s.length){for(let t=0;t<s.length;t++)s[t]&&!s[t]._internal_&&"object"==typeof s[t]&&(s[t]=this._internal_.model(s[t]));const i=this._internal_.nativeData.splice(t,e,...s);return this._internal_.didMutate(),i}{const s=this._internal_.nativeData.splice(t,e);return this._internal_.didMutate(),s}}return[]}reverse(){this._internal_.nativeData.length>1&&(this._internal_.nativeData.reverse(),this._internal_.didMutate())}sort(t){const e=this._internal_.nativeData;if(e.length>1){const s=e.slice(0);e.sort(t);for(let t=0;t<e.length;t++)if(e[t]!==s[t]){this._internal_.didMutate();break}}}filterInPlace(t){const e=this._internal_.nativeData;let s=!1;for(let i=e.length-1;i>=0;i--)t(e[i],i,e)||(e.splice(i,1),s=!0);s&&this._internal_.didMutate()}clear(){const t=this._internal_.nativeData;if(t.length){for(;t.length;)t.pop();this._internal_.didMutate()}}observe(t,e={}){return(e.throttle||0)>0?this._internal_.observe("*",w.throttle(t,e.throttle),e.cancelable,e.silent):(e.defer||0)>0?this._internal_.observe("*",j(t,e.defer),e.cancelable,e.silent):this._internal_.observe("*",t,e.cancelable,e.silent)}track(t={}){if(this._internal_.stateTracker)throw new Error("Cannot track state of ReactiveArray because it is already being tracked.");const e=this._internal_.stateTracker=new g(t.onTrack,t.maxEntries),s=(t.throttle||0)>0||(t.defer||0)>0;this._internal_.observe("*",(t=>e.add(t,s)),!1,!1)}undo(){this.restore(this._internal_.stateTracker?.prev())}redo(){this.restore(this._internal_.stateTracker?.next())}restore(t){const e=this._internal_.stateTracker;e&&e.has(t)&&this._internal_.setData(e.get(t),!1)}}const dt={createElement:function(t){return"function"==typeof t&&(t=t()),e.innerHTML=t,e.content.firstElementChild},defineComponent:function(e,s){const i=new p(e,s),r=class extends R{constructor(){super(i)}};for(const t in s)s.hasOwnProperty(t)&&"initialize"!==t&&"function"==typeof s[t]&&(r.prototype[t]=s[t]);t.customElements.define(e,r);const n=t=>p.createTag(e,t);return n.state=t=>i.setupStateOnce()?S._from_(i.state,t):t,n.render=t=>p.createNode(e,t,n.state),n},renderList:b,Router:L,deleteRequest:function(t,e,s){return Z(t,"DELETE",s,e)},getRequest:function(t,e=0,s=""){const i=et(t);return function(t){return ct.get(t).then((e=>{if(e){if(e.expires<Date.now())throw ct.delete(t),!1;return e.value}throw!1}))}(i).then((t=>t)).catch((()=>Z(t,"GET",s).then((t=>(e>0&&function(t,e,s){(ct||(ct=new ht({name:"sekoia::network::cache"}))).set(t,{value:e,expires:Date.now()+1e3*s})}(i,t,e),t)))))},onRequestStart:function(t,e="*",s=!1){ut(t,e,X,s)},onRequestStop:function(t,e="*",s=!1){ut(t,e,Y,s)},postRequest:function(t,e,s){return Z(t,"POST",s,e)},putRequest:function(t,e,s){return Z(t,"PUT",s,e)},createState:function(t,e){return Array.isArray(t)?new lt(t,e):new S(t)},PersistentStorage:ht,ReactiveArray:lt,ReactiveObject:S,deepClone:s,deepEqual:r,hashString:et,throttle:function(t,e){let s=0;const i=()=>s=0;return r=>{s||(t(r),s=setTimeout(i,e))}},defer:j};"object"==typeof module&&"object"==typeof module.exports?module.exports=dt:"function"==typeof define&&define.amd?define("Sekoia",[],(function(){return dt})):t.Sekoia=dt}(window||this);